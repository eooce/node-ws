<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>æ·¡ç´«ç§‘æŠ€æ„Ÿåšå®¢ Â· é«˜çº§ç‰ˆ</title>
  <style>
    :root{
      --primary:#c9a7ff;
      --primary-2:#b084ff;
      --bg:#f7f4ff;
      --card:#fff;
      --text:#222;
      --muted:#666;
      --glass: rgba(255,255,255,0.6);
    }
    [data-theme="dark"]{
      --primary:#b084ff;
      --primary-2:#8a5cff;
      --bg:#0f0b14;
      --card:#13101a;
      --text:#e9e6ff;
      --muted:#b5aee6;
      --glass: rgba(255,255,255,0.03);
    }

    *{box-sizing:border-box}
    body{margin:0;font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system; background:radial-gradient(circle at 10% 10%, rgba(201,167,255,0.08), transparent 10%), radial-gradient(circle at 90% 90%, rgba(176,145,255,0.06), transparent 8%), var(--bg); color:var(--text); transition:background .3s, color .3s}

    /* èƒŒæ™¯å…‰æ•ˆ */
    .bg-glow{position:fixed;inset:0;pointer-events:none;z-index:0;}
    .blob{position:absolute;width:420px;height:420px;border-radius:50%;filter:blur(80px);opacity:.6;mix-blend-mode:screen;animation:float 12s ease-in-out infinite}
    .blob.a{left:-10%;top:-10%;background:linear-gradient(135deg,var(--primary),var(--primary-2))}
    .blob.b{right:-8%;bottom:-5%;background:linear-gradient(135deg,#ffd1f7, #b084ff);animation-duration:18s;opacity:.5}
    @keyframes float{0%{transform:translateY(0) scale(1)}50%{transform:translateY(-30px) scale(1.05)}100%{transform:translateY(0) scale(1)}}

    /* å¯¼èˆª */
    header{position:sticky;top:0;background:var(--glass);backdrop-filter:blur(8px);z-index:20;border-bottom:1px solid rgba(0,0,0,0.04)}
    .nav{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;padding:12px 20px;gap:12px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--primary),var(--primary-2));box-shadow:0 6px 20px rgba(138,92,255,0.18);display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
    .sitename{font-weight:700}
    .nav-links{display:flex;gap:14px;align-items:center}
    .nav-links a{color:var(--text);text-decoration:none;font-weight:600}
    .search-input{padding:8px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);min-width:220px;background:transparent}
    .theme-btn{margin-left:8px;padding:8px;border-radius:8px;border:none;cursor:pointer;background:transparent}

    /* ä¸»ä½“å¸ƒå±€ */
    .wrap{max-width:1200px;margin:28px auto;padding:0 18px;display:grid;grid-template-columns:280px 1fr;gap:24px;align-items:start;z-index:10}

    /* ä¾§æ  */
    .sidebar{position:sticky;top:82px}
    .card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 8px 30px rgba(15,10,20,0.04);border:1px solid rgba(0,0,0,0.04)}
    .profile{display:flex;gap:12px;align-items:center}
    .avatar{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--primary),var(--primary-2));display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
    .tags{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
    .tag{padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,rgba(201,167,255,0.12),rgba(176,145,255,0.08));cursor:pointer;font-weight:600}

    /* æ–‡ç« åŒº */
    .main{min-height:40vh}
    .controls{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;gap:12px}
    .sort{display:flex;gap:8px}

    /* åˆ—è¡¨ä¸å¡ç‰‡ */
    .posts{display:grid;grid-template-columns:1fr;gap:18px}
    .post{background:var(--card);border-radius:12px;padding:18px;border-left:4px solid transparent;box-shadow:0 6px 20px rgba(12,8,20,0.04);overflow:hidden;transform-origin:center;transition:transform .28s, box-shadow .28s}
    .post:hover{transform:translateY(-6px);box-shadow:0 16px 40px rgba(12,8,20,0.08)}
    .post .meta{display:flex;gap:12px;align-items:center;color:var(--muted);font-size:13px}
    .post h3{margin:8px 0 6px}
    .excerpt{color:var(--muted);line-height:1.6}
    .post .taglist{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
    .post .pill{padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,rgba(201,167,255,0.12),rgba(176,145,255,0.06));font-weight:600;cursor:pointer}

    /* åˆ†é¡µ & åŠ è½½ */
    .pager{display:flex;gap:8px;justify-content:center;margin-top:18px}
    .btn{padding:8px 14px;border-radius:10px;border:none;cursor:pointer;background:linear-gradient(90deg,var(--primary),var(--primary-2));color:white;font-weight:700}
    .ghost{background:transparent;border:1px solid rgba(0,0,0,0.06)}

    /* è¯„è®ºåŒº */
    .comments{margin-top:12px}
    .comment{padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(0,0,0,0.02), transparent);margin-bottom:8px}
    .comment small{color:var(--muted)}
    .comment-form{display:flex;flex-direction:column;gap:8px;margin-top:8px}
    .input,textarea{padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:transparent;color:var(--text)}

    /* Markdown æ¸²æŸ“å™¨æ ·å¼ */
    .content h1,.content h2,.content h3{margin:10px 0}
    .content pre{background:#0f0f12;color:#fff;padding:12px;border-radius:8px;overflow:auto}
    .content code{background:rgba(0,0,0,0.05);padding:2px 6px;border-radius:6px}

    /* å“åº”å¼ */
    @media (max-width:980px){.wrap{grid-template-columns:1fr;}.sidebar{position:relative;order:2}.main{order:1}.nav-links .search-input{display:none}}
    @media (max-width:600px){.nav{padding:10px}.logo{display:flex;gap:8px}.sitename{display:none}}

    /* åŠ¨ç”»å¢å¼º */
    .fade-in{animation:fadeIn .6s ease both}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

  </style>
</head>
<body data-theme="light">
  <div class="bg-glow" aria-hidden>
    <div class="blob a"></div>
    <div class="blob b"></div>
  </div>

  <header>
    <div class="nav">
      <div class="brand">
        <div class="logo">BP</div>
        <div class="sitename">æ·¡ç´«ç§‘æŠ€åšå®¢</div>
      </div>
      <div class="nav-links">
        <input id="search" class="search-input" placeholder="æœç´¢æ–‡ç« ã€æ ‡ç­¾æˆ–å…³é”®å­—..." />
        <button id="themeToggle" class="theme-btn" title="åˆ‡æ¢æš—é»‘/æµ…è‰²">ğŸŒ“</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- ä¾§æ  -->
    <aside class="sidebar">
      <div class="card profile fade-in">
        <div style="display:flex;align-items:center;gap:12px">
          <div class="avatar">æ·¡</div>
          <div>
            <div style="font-weight:700">ä½œè€…ï¼šæ·¡ç´«</div>
            <div style="color:var(--muted);font-size:13px">å†™æŠ€æœ¯ã€å†™æœªæ¥</div>
          </div>
        </div>

        <div style="margin-top:12px">
          <div style="font-weight:700;margin-bottom:8px">æ ‡ç­¾</div>
          <div id="tagCloud" class="tags"></div>
        </div>
      </div>

      <div style="height:18px"></div>

      <div class="card fade-in">
        <div style="font-weight:700;margin-bottom:8px">è¿‘æœŸæ–‡ç« </div>
        <div id="recentList"></div>
      </div>
    </aside>

    <!-- ä¸»å†…å®¹ -->
    <section class="main">
      <div class="controls fade-in">
        <div><strong id="resultCount">0</strong> æ¡ç»“æœ</div>
        <div class="sort">
          <select id="perPage" class="input" style="padding:8px;border-radius:8px">
            <option value="5">5 / é¡µ</option>
            <option value="8">8 / é¡µ</option>
            <option value="12">12 / é¡µ</option>
          </select>
        </div>
      </div>

      <div id="posts" class="posts"></div>

      <div class="pager">
        <button id="prevBtn" class="btn ghost">ä¸Šä¸€é¡µ</button>
        <div style="min-width:120px;display:flex;align-items:center;justify-content:center">ç¬¬ <span id="currentPage">1</span> é¡µ</div>
        <button id="nextBtn" class="btn ghost">ä¸‹ä¸€é¡µ</button>
      </div>

      <div style="text-align:center;margin-top:14px">
        <button id="loadMore" class="btn">åŠ è½½æ›´å¤š</button>
      </div>
    </section>
  </main>

  <footer style="max-width:1200px;margin:28px auto;padding:18px;text-align:center;color:var(--muted)">Â© 2025 æ·¡ç´«ç§‘æŠ€åšå®¢ Â· Built with static HTML â€¢ æ”¯æŒ Markdown</footer>

  <script>
    /* =========== å‡æ•°æ®ï¼ˆç¤ºä¾‹æ–‡ç« ï¼‰ =========== */
    const POSTS = Array.from({length:24}).map((_,i)=>({
      id:i+1,
      title:`ç”¨ Markdown å†™ä½œï¼šç¬¬ ${i+1} ç¯‡ç¤ºä¾‹æ–‡ç« `,
      tags: (i%3===0)?['å‰ç«¯','æ•™ç¨‹']: (i%3===1)?['åç«¯','æ¶æ„']: ['å·¥å…·','æ•ˆç‡'],
      date: new Date(Date.now() - i*86400000).toISOString().slice(0,10),
      excerpt:`è¿™æ˜¯ç¬¬ ${i+1} ç¯‡æ–‡ç« çš„æ‘˜è¦ â€” ä½¿ç”¨æ·¡ç´«ä¸»é¢˜ã€æ”¯æŒæœç´¢ã€åˆ†é¡µä¸æ ‡ç­¾è¿‡æ»¤ã€‚`,
      md: `# ç¬¬ ${i+1} ç¯‡æ ‡é¢˜\n\nè¿™æ˜¯æ–‡ç« çš„**ç¤ºä¾‹æ­£æ–‡**ã€‚\n\n- è¦ç‚¹ä¸€\n- è¦ç‚¹äºŒ\n\n\`\`\`js\nconsole.log('Hello world', ${i+1})\n\`\`\``
    }))

    /* çŠ¶æ€ */
    let state = {query:'',tag:null,page:1,perPage:5,filtered:POSTS.slice()}

    /* ç®€æ˜“ Markdown æ¸²æŸ“å™¨ï¼ˆæ”¯æŒ h1-h3, lists, code, bold, italic, linksï¼‰ */
    function renderMarkdown(md){
      const esc = (s)=>s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
      const lines = md.split('\n')
      let out = ''
      let inCode=false, codeLang=''
      for(let line of lines){
        if(line.match(/^```(.*)/)){
          if(!inCode){ inCode=true; codeLang=(line.match(/^```(.*)/)||[])[1]||''; out+=`<pre><code data-lang="${codeLang}">`; continue }
          else{ inCode=false; out+=`</code></pre>`; continue }
        }
        if(inCode){ out+=esc(line)+'\n'; continue }
        if(line.match(/^###\s+(.*)/)) out+=`<h3>${line.replace(/^###\s+/,'')}</h3>`
        else if(line.match(/^##\s+(.*)/)) out+=`<h2>${line.replace(/^##\s+/,'')}</h2>`
        else if(line.match(/^#\s+(.*)/)) out+=`<h1>${line.replace(/^#\s+/,'')}</h1>`
        else if(line.match(/^\-\s+(.*)/)){
          if(!out.endsWith('<ul>')) out+='<ul>'
          out+=`<li>${line.replace(/^-\\s+/,'')}</li>`
        }
        else if(line.trim()===''){ out+="<p></p>" }
        else{
          let html = esc(line)
          html = html.replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>')
          html = html.replace(/\*(.*?)\*/g,'<em>$1</em>')
          html = html.replace(/`([^`]+)`/g,'<code>$1</code>')
          html = html.replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank">$1</a>')
          out+=`<p>${html}</p>`
        }
      }
      out = out.replace(/<ul>([\s\S]*?)<p><\/p>/g,'<ul>$1</ul>')
      out = out.replace(/<p><\/p>/g,'')
      return out
    }

    /* æ¸²æŸ“ tag cloud */
    function renderTagCloud(){
      const tags = {}
      POSTS.forEach(p=>p.tags.forEach(t=>tags[t]=(tags[t]||0)+1))
      const container = document.getElementById('tagCloud')
      container.innerHTML = ''
      Object.keys(tags).sort((a,b)=>tags[b]-tags[a]).forEach(t=>{
        const el = document.createElement('div')
        el.className='tag'
        el.textContent = `${t} (${tags[t]})`
        el.onclick = ()=>{ state.tag = t; state.page=1; applyFilters(); }
        container.appendChild(el)
      })
    }

    /* æ¸²æŸ“è¿‘æœŸæ–‡ç«  */
    function renderRecent(){
      const list = document.getElementById('recentList')
      list.innerHTML = ''
      POSTS.slice(0,6).forEach(p=>{
        const a = document.createElement('div')
        a.style.padding='8px 0'; a.style.borderBottom='1px dashed rgba(0,0,0,0.04)'
        a.innerHTML = `<div style=\"font-weight:700\">${p.title}</div><div style=\"color:var(--muted);font-size:13px\">${p.date}</div>`
        list.appendChild(a)
      })
    }

    /* ä¸»æ¸²æŸ“ï¼šæŒ‰è¿‡æ»¤+åˆ†é¡µæ¸²æŸ“ posts */
    function applyFilters(){
      const q = state.query.trim().toLowerCase()
      let arr = POSTS.filter(p=>{
        const inTag = state.tag ? p.tags.includes(state.tag) : true
        const inQuery = q ? (p.title.toLowerCase().includes(q)||p.excerpt.toLowerCase().includes(q)||p.tags.join(' ').toLowerCase().includes(q)) : true
        return inTag && inQuery
      })
      state.filtered = arr
      renderPage()
    }

    function renderPage(){
      const el = document.getElementById('posts')
      el.innerHTML = ''
      const total = state.filtered.length
      document.getElementById('resultCount').textContent = total
      const per = state.perPage
      const start = (state.page-1)*per
      const pageItems = state.filtered.slice(start, start+per)
      pageItems.forEach(p=>{
        const card = document.createElement('article')
        card.className='post fade-in'
        card.innerHTML = `
          <div class="meta"><small>${p.date}</small></div>
          <h3>${p.title}</h3>
          <div class="excerpt">${p.excerpt}</div>
          <div class="taglist">${p.tags.map(t=>`<span class="pill">${t}</span>`).join('')}</div>
          <div style="margin-top:12px"><button class="btn" data-id="${p.id}">é˜…è¯»å…¨æ–‡</button></div>
          <div class="comments" id="comments-${p.id}"></div>
        `
        el.appendChild(card)
      })

      document.getElementById('currentPage').textContent = state.page
      document.getElementById('prevBtn').disabled = state.page<=1
      document.getElementById('nextBtn').disabled = (state.page*state.perPage)>=state.filtered.length

      document.querySelectorAll('[data-id]').forEach(b=>b.onclick = (e)=>openPost(e.target.getAttribute('data-id')))
    }

    function openPost(id){
      const p = POSTS.find(x=>x.id==id)
      if(!p) return
      const modal = document.createElement('div')
      modal.style.position='fixed';modal.style.inset=0;modal.style.background='rgba(0,0,0,0.6)';modal.style.zIndex=60;modal.style.display='flex';modal.style.alignItems='center';modal.style.justifyContent='center'
      const box = document.createElement('div')
      box.style.width='min(1000px,96%)';box.style.maxHeight='86vh';box.style.overflow='auto';box.style.borderRadius='12px';box.style.padding='20px';box.style.background='var(--card)'
      box.innerHTML = `
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;"> <h2 style='margin:0'>${p.title}</h2> <button id='close'>å…³é—­</button></div>
        <div style="color:var(--muted);margin-bottom:12px">${p.date} â€¢ ${p.tags.join(', ')}</div>
        <div class="content">${renderMarkdown(p.md)}</div>
        <div class="comments" style="margin-top:18px"><h4>è¯„è®º</h4><div id="list-${p.id}"></div>
          <div class="comment-form"><input id="name-${p.id}" placeholder="ä½ çš„åå­—" class="input"/><textarea id="text-${p.id}" placeholder="å†™ä¸‹ä½ çš„è¯„è®º..." rows=4 class="input"></textarea><button id="submit-${p.id}" class="btn">æäº¤è¯„è®º</button></div>
        </div>
      `
      modal.appendChild(box);document.body.appendChild(modal)
      document.getElementById('close').onclick = ()=>modal.remove()

      const key = `comments_post_${p.id}`
      function loadComments(){
        const list = document.getElementById(`list-${p.id}`)
        const data = JSON.parse(localStorage.getItem(key)||'[]')
        list.innerHTML = data.map(c=>`<div class="comment"><strong>${c.name}</strong> <small>${c.time}</small><div>${c.text}</div></div>`).join('')
      }
      loadComments()

      document.getElementById(`submit-${p.id}`).onclick = ()=>{
        const name = document.getElementById(`name-${p.id}`).value||'åŒ¿å'
        const text = document.getElementById(`text-${p.id}`).value||''
        if(!text.trim()) return alert('è¯·è¾“å…¥è¯„è®ºå†…å®¹')
        const arr = JSON.parse(localStorage.getItem(key)||'[]')
        arr.unshift({name,text,time:new Date().toLocaleString()})
        localStorage.setItem(key, JSON.stringify(arr))
        loadComments()
        document.getElementById(`name-${p.id}`).value=''
        document.getElementById(`text-${p.id}`).value=''
      }
    }

    document.getElementById('loadMore').onclick = ()=>{
      const maxPage = Math.ceil(state.filtered.length/state.perPage)
      if(state.page<maxPage){ state.page++; renderPage() }
      else{
        const start = POSTS.length+1
        for(let i=0;i<6;i++){ POSTS.push({id:start+i,title:`æ–°å¢ç¤ºä¾‹æ–‡ç«  ${start+i}`,tags:['å·¥å…·'],date:new Date().toISOString().slice(0,10),excerpt:'åŠ¨æ€åŠ è½½çš„æ–‡ç« ç¤ºä¾‹',md:`# æ–°å¢æ–‡ç«  ${start+i}\nè¿™æ˜¯åŠ¨æ€åŠ è½½çš„å†…å®¹`}) }
        applyFilters()
      }
    }

    document.getElementById('prevBtn').onclick = ()=>{ if(state.page>1){state.page--; renderPage()} }
    document.getElementById('nextBtn').onclick = ()=>{ if((state.page*state.perPage)<state.filtered.length){state.page++; renderPage()} }

    document.getElementById('perPage').onchange = (e)=>{ state.perPage=parseInt(e.target.value); state.page=1; renderPage() }

    const searchInput = document.getElementById('search')
    searchInput.addEventListener('input', (e)=>{ state.query = e.target.value; state.page=1; applyFilters() })

    document.addEventListener('click', (e)=>{
      if(e.target.classList.contains('pill')){ const t=e.target.textContent; state.tag=t; state.page=1; applyFilters() }
    })

    renderTagCloud(); renderRecent(); applyFilters();

    const themeBtn = document.getElementById('themeToggle')
    function setTheme(t){ document.body.setAttribute('data-theme', t); localStorage.setItem('theme', t) }
    const saved = localStorage.getItem('theme')||'light'
    setTheme(saved)
    themeBtn.onclick = ()=> setTheme(document.body.getAttribute('data-theme')==='dark'?'light':'dark')
  </script>
</body>
</html>
